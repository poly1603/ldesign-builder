{"version":3,"file":"bundler.js","sourceRoot":"","sources":["../../src/types/bundler.ts"],"names":[],"mappings":"AAAA;;GAEG;AASH;;GAEG;AACH,MAAM,CAAN,IAAY,aAeX;AAfD,WAAY,aAAa;IACvB,WAAW;IACX,gDAA+B,CAAA;IAC/B,WAAW;IACX,8CAA6B,CAAA;IAC7B,SAAS;IACT,gCAAe,CAAA;IACf,UAAU;IACV,sCAAqB,CAAA;IACrB,UAAU;IACV,sCAAqB,CAAA;IACrB,WAAW;IACX,gCAAe,CAAA;IACf,UAAU;IACV,sCAAqB,CAAA;AACvB,CAAC,EAfW,aAAa,KAAb,aAAa,QAexB;AA4BD,wCAAwC;AACxC,OAAO,EAAE,cAAc,EAAE,MAAM,WAAW,CAAA","sourcesContent":["/**\n * 打包器相关类型定义\n */\n\nimport type { BundlerFeature } from './adapter'\n\n/**\n * 支持的打包器类型\n */\nexport type BundlerType = 'rollup' | 'rolldown'\n\n/**\n * 打包器状态\n */\nexport enum BundlerStatus {\n  /** 未初始化 */\n  UNINITIALIZED = 'uninitialized',\n  /** 初始化中 */\n  INITIALIZING = 'initializing',\n  /** 就绪 */\n  READY = 'ready',\n  /** 构建中 */\n  BUILDING = 'building',\n  /** 监听中 */\n  WATCHING = 'watching',\n  /** 错误状态 */\n  ERROR = 'error',\n  /** 已销毁 */\n  DISPOSED = 'disposed'\n}\n\n/**\n * 打包器信息\n */\nexport interface BundlerInfo {\n  /** 打包器名称 */\n  name: BundlerType\n\n  /** 打包器版本 */\n  version: string\n\n  /** 是否可用 */\n  available: boolean\n\n  /** 安装路径 */\n  installPath?: string\n\n  /** 支持的功能 */\n  features: BundlerFeature[]\n\n  /** 性能特征 */\n  performance: BundlerPerformanceProfile\n\n  /** 兼容性信息 */\n  compatibility: BundlerCompatibility\n}\n\n// BundlerFeature 已在 adapter.ts 中定义，这里导入\nexport { BundlerFeature } from './adapter'\n\n/**\n * 打包器性能特征\n */\nexport interface BundlerPerformanceProfile {\n  /** 构建速度等级 */\n  buildSpeed: 'slow' | 'medium' | 'fast' | 'very-fast'\n\n  /** 内存使用等级 */\n  memoryUsage: 'low' | 'medium' | 'high' | 'very-high'\n\n  /** 启动时间 */\n  startupTime: 'fast' | 'medium' | 'slow'\n\n  /** 增量构建性能 */\n  incrementalBuild: 'excellent' | 'good' | 'fair' | 'poor'\n\n  /** 大型项目支持 */\n  largeProjectSupport: 'excellent' | 'good' | 'fair' | 'poor'\n\n  /** 并行处理能力 */\n  parallelProcessing: 'excellent' | 'good' | 'fair' | 'poor'\n}\n\n/**\n * 打包器兼容性\n */\nexport interface BundlerCompatibility {\n  /** Node.js 版本要求 */\n  nodeVersion: string\n\n  /** 操作系统支持 */\n  platforms: ('win32' | 'darwin' | 'linux')[]\n\n  /** 架构支持 */\n  architectures: ('x64' | 'arm64' | 'ia32')[]\n\n  /** 插件兼容性 */\n  pluginCompatibility: {\n    /** Rollup 插件兼容性 */\n    rollup: 'full' | 'partial' | 'none'\n    /** Webpack 插件兼容性 */\n    webpack: 'full' | 'partial' | 'none'\n    /** Vite 插件兼容性 */\n    vite: 'full' | 'partial' | 'none'\n  }\n\n  /** 配置兼容性 */\n  configCompatibility: {\n    /** 与其他工具的配置兼容性 */\n    rollup: boolean\n    webpack: boolean\n    vite: boolean\n  }\n}\n\n/**\n * 打包器配置\n */\nexport interface BundlerConfig {\n  /** 打包器类型 */\n  type: BundlerType\n\n  /** 打包器选项 */\n  options?: BundlerOptions\n\n  /** 插件配置 */\n  plugins?: any[]\n\n  /** 优化配置 */\n  optimization?: OptimizationConfig\n\n  /** 开发配置 */\n  development?: DevelopmentConfig\n\n  /** 实验性功能 */\n  experimental?: ExperimentalConfig\n}\n\n/**\n * 打包器选项\n */\nexport interface BundlerOptions {\n  /** 工作目录 */\n  cwd?: string\n\n  /** 缓存目录 */\n  cacheDir?: string\n\n  /** 临时目录 */\n  tempDir?: string\n\n  /** 日志级别 */\n  logLevel?: 'silent' | 'error' | 'warn' | 'info' | 'debug'\n\n  /** 是否启用颜色输出 */\n  colors?: boolean\n\n  /** 是否清屏 */\n  clearScreen?: boolean\n\n  /** 构建超时时间 */\n  timeout?: number\n\n  /** 最大内存使用 */\n  maxMemory?: string | number\n\n  /** 工作线程数 */\n  workers?: number | 'auto'\n}\n\n/**\n * 优化配置\n */\nexport interface OptimizationConfig {\n  /** 是否启用 Tree Shaking */\n  treeshake?: boolean\n\n  /** 是否启用代码分割 */\n  codeSplitting?: boolean\n\n  /** 是否启用压缩 */\n  minify?: boolean\n\n  /** 是否启用 gzip 压缩 */\n  gzip?: boolean\n\n  /** 是否启用 brotli 压缩 */\n  brotli?: boolean\n\n  /** 是否移除未使用的代码 */\n  removeUnusedCode?: boolean\n\n  /** 是否内联小文件 */\n  inlineSmallFiles?: boolean\n\n  /** 资源优化 */\n  assets?: {\n    /** 图片优化 */\n    images?: boolean\n    /** 字体优化 */\n    fonts?: boolean\n    /** SVG 优化 */\n    svg?: boolean\n  }\n}\n\n/**\n * 开发配置\n */\nexport interface DevelopmentConfig {\n  /** 是否启用热重载 */\n  hmr?: boolean\n\n  /** 是否启用实时重载 */\n  liveReload?: boolean\n\n  /** 开发服务器配置 */\n  server?: {\n    /** 端口号 */\n    port?: number\n    /** 主机名 */\n    host?: string\n    /** 是否启用 HTTPS */\n    https?: boolean\n    /** 是否自动打开浏览器 */\n    open?: boolean\n  }\n\n  /** 是否启用源码映射 */\n  sourcemap?: boolean | 'inline'\n\n  /** 是否启用错误覆盖 */\n  errorOverlay?: boolean\n\n  /** 是否启用进度显示 */\n  progress?: boolean\n}\n\n/**\n * 实验性功能配置\n */\nexport interface ExperimentalConfig {\n  /** 是否启用实验性功能 */\n  enabled?: boolean\n\n  /** 具体的实验性功能 */\n  features?: string[]\n\n  /** 实验性插件 */\n  plugins?: any[]\n\n  /** 实验性优化 */\n  optimizations?: string[]\n}\n\n/**\n * 打包器检测结果\n */\nexport interface BundlerDetectionResult {\n  /** 可用的打包器 */\n  available: BundlerInfo[]\n\n  /** 推荐的打包器 */\n  recommended: BundlerType\n\n  /** 推荐理由 */\n  reason: string\n\n  /** 性能对比 */\n  performance: Record<BundlerType, BundlerPerformanceMetrics>\n\n  /** 兼容性分析 */\n  compatibility: Record<BundlerType, CompatibilityAnalysis>\n}\n\n/**\n * 打包器性能指标\n */\nexport interface BundlerPerformanceMetrics {\n  /** 构建时间 */\n  buildTime: number\n\n  /** 内存使用 */\n  memoryUsage: number\n\n  /** 启动时间 */\n  startupTime: number\n\n  /** 包大小 */\n  bundleSize: number\n\n  /** 缓存命中率 */\n  cacheHitRate: number\n\n  /** 并行效率 */\n  parallelEfficiency: number\n}\n\n/**\n * 兼容性分析\n */\nexport interface CompatibilityAnalysis {\n  /** 整体兼容性评分 */\n  score: number\n\n  /** 插件兼容性 */\n  pluginCompatibility: number\n\n  /** 配置兼容性 */\n  configCompatibility: number\n\n  /** 功能兼容性 */\n  featureCompatibility: number\n\n  /** 兼容性问题 */\n  issues: CompatibilityIssue[]\n\n  /** 解决方案 */\n  solutions: string[]\n}\n\n/**\n * 兼容性问题\n */\nexport interface CompatibilityIssue {\n  /** 问题类型 */\n  type: 'plugin' | 'config' | 'feature' | 'dependency'\n\n  /** 问题描述 */\n  description: string\n\n  /** 严重程度 */\n  severity: 'low' | 'medium' | 'high' | 'critical'\n\n  /** 影响范围 */\n  impact: string[]\n\n  /** 解决方案 */\n  solution?: string\n\n  /** 相关文档 */\n  documentation?: string\n}\n\n/**\n * 打包器切换选项\n */\nexport interface BundlerSwitchOptions {\n  /** 目标打包器 */\n  target: BundlerType\n\n  /** 是否保留配置 */\n  preserveConfig?: boolean\n\n  /** 是否迁移插件 */\n  migratePlugins?: boolean\n\n  /** 是否备份原配置 */\n  backup?: boolean\n\n  /** 迁移策略 */\n  migrationStrategy?: 'conservative' | 'aggressive' | 'custom'\n\n  /** 自定义迁移规则 */\n  customRules?: MigrationRule[]\n}\n\n/**\n * 迁移规则\n */\nexport interface MigrationRule {\n  /** 规则名称 */\n  name: string\n\n  /** 源配置路径 */\n  from: string\n\n  /** 目标配置路径 */\n  to: string\n\n  /** 转换函数 */\n  transform?: (value: any) => any\n\n  /** 是否必需 */\n  required?: boolean\n\n  /** 默认值 */\n  defaultValue?: any\n}\n\n/**\n * 打包器切换结果\n */\nexport interface BundlerSwitchResult {\n  /** 是否成功 */\n  success: boolean\n\n  /** 新的打包器 */\n  newBundler: BundlerType\n\n  /** 迁移的配置 */\n  migratedConfig: any\n\n  /** 迁移的插件 */\n  migratedPlugins: any[]\n\n  /** 迁移报告 */\n  migrationReport: MigrationReport\n\n  /** 警告信息 */\n  warnings: string[]\n\n  /** 错误信息 */\n  errors: string[]\n}\n\n/**\n * 迁移报告\n */\nexport interface MigrationReport {\n  /** 迁移的配置项数量 */\n  configItemsMigrated: number\n\n  /** 迁移的插件数量 */\n  pluginsMigrated: number\n\n  /** 无法迁移的配置项 */\n  unmigratableConfigs: string[]\n\n  /** 无法迁移的插件 */\n  unmigratablePlugins: string[]\n\n  /** 需要手动处理的项目 */\n  manualActions: ManualAction[]\n\n  /** 迁移时间 */\n  migrationTime: number\n}\n\n/**\n * 手动操作\n */\nexport interface ManualAction {\n  /** 操作类型 */\n  type: 'config' | 'plugin' | 'dependency' | 'file'\n\n  /** 操作描述 */\n  description: string\n\n  /** 相关文件 */\n  files?: string[]\n\n  /** 建议的操作 */\n  suggestedAction: string\n\n  /** 参考文档 */\n  documentation?: string\n}\n"]}