{"version":3,"file":"banner-generator.js","sourceRoot":"","sources":["../../src/utils/banner-generator.ts"],"names":[],"mappings":"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","sourcesContent":["/**\r\n * Banner 生成器\r\n * \r\n * 为打包产物生成标识 banner\r\n * \r\n * @author LDesign Team\r\n * @version 1.0.0\r\n */\r\n\r\nimport fs from 'fs'\r\nimport path from 'path'\r\n\r\nexport interface BannerOptions {\r\n  /** 打包工具名称 */\r\n  bundler: string\r\n  /** 打包工具版本 */\r\n  bundlerVersion?: string\r\n  /** 项目名称 */\r\n  projectName?: string\r\n  /** 项目版本 */\r\n  projectVersion?: string\r\n  /** 项目描述 */\r\n  projectDescription?: string\r\n  /** 项目作者 */\r\n  projectAuthor?: string\r\n  /** 项目许可证 */\r\n  projectLicense?: string\r\n  /** 构建时间 */\r\n  buildTime?: Date\r\n  /** 构建模式 */\r\n  buildMode?: string\r\n  /** 是否压缩 */\r\n  minified?: boolean\r\n  /** 自定义信息 */\r\n  customInfo?: Record<string, string>\r\n  /** Banner 样式 */\r\n  style?: 'default' | 'compact' | 'detailed'\r\n}\r\n\r\nexport class BannerGenerator {\r\n  /**\r\n   * 生成 banner 字符串\r\n   */\r\n  static generate(options: BannerOptions): string {\r\n    const style = options.style ?? 'default'\r\n\r\n    switch (style) {\r\n      case 'compact':\r\n        return this.generateCompactBanner(options)\r\n      case 'detailed':\r\n        return this.generateDetailedBanner(options)\r\n      default:\r\n        return this.generateDefaultBanner(options)\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 生成默认样式的 banner\r\n   */\r\n  private static generateDefaultBanner(options: BannerOptions): string {\r\n    const {\r\n      bundler,\r\n      bundlerVersion,\r\n      projectName,\r\n      projectVersion,\r\n      buildTime = this.getCorrectBuildTime(),\r\n      buildMode = 'production',\r\n      minified = false\r\n    } = options\r\n\r\n    const lines = [\r\n      `Built with ${bundler}${bundlerVersion ? ` v${bundlerVersion}` : ''}`,\r\n      `Build time: ${this.formatBuildTime(buildTime)}`,\r\n      `Build mode: ${buildMode}`,\r\n      `Minified: ${minified ? 'Yes' : 'No'}`\r\n    ]\r\n\r\n    if (projectName) {\r\n      lines.unshift(`${projectName}${projectVersion ? ` v${projectVersion}` : ''}`)\r\n    }\r\n\r\n    const maxLength = Math.max(...lines.map(line => line.length))\r\n    const border = '*'.repeat(maxLength + 4)\r\n\r\n    return [\r\n      `/*!`,\r\n      ` * ${border}`,\r\n      ...lines.map(line => ` * ${line.padEnd(maxLength)} *`),\r\n      ` * ${border}`,\r\n      ` */`\r\n    ].join('\\n')\r\n  }\r\n\r\n  /**\r\n   * 生成紧凑样式的 banner\r\n   */\r\n  private static generateCompactBanner(options: BannerOptions): string {\r\n    const {\r\n      bundler,\r\n      bundlerVersion,\r\n      projectName,\r\n      projectVersion,\r\n      buildTime = this.getCorrectBuildTime()\r\n    } = options\r\n\r\n    const parts = []\r\n\r\n    if (projectName) {\r\n      parts.push(`${projectName}${projectVersion ? ` v${projectVersion}` : ''}`)\r\n    }\r\n\r\n    parts.push(`Built with ${bundler}${bundlerVersion ? ` v${bundlerVersion}` : ''}`)\r\n    parts.push(this.formatBuildTime(buildTime).split(' ')[0])\r\n\r\n    return `/*! ${parts.join(' | ')} */`\r\n  }\r\n\r\n  /**\r\n   * 生成详细样式的 banner\r\n   */\r\n  private static generateDetailedBanner(options: BannerOptions): string {\r\n    const {\r\n      bundler,\r\n      bundlerVersion,\r\n      projectName,\r\n      projectVersion,\r\n      projectDescription,\r\n      projectAuthor,\r\n      projectLicense,\r\n      buildTime = this.getCorrectBuildTime(),\r\n      buildMode = 'production',\r\n      minified = false,\r\n      customInfo = {}\r\n    } = options\r\n\r\n    const lines = []\r\n\r\n    // 项目信息\r\n    if (projectName) {\r\n      lines.push(`Project: ${projectName}${projectVersion ? ` v${projectVersion}` : ''}`)\r\n    }\r\n    if (projectDescription) {\r\n      lines.push(`Description: ${projectDescription}`)\r\n    }\r\n    if (projectAuthor) {\r\n      lines.push(`Author: ${projectAuthor}`)\r\n    }\r\n    if (projectLicense) {\r\n      lines.push(`License: ${projectLicense}`)\r\n    }\r\n\r\n    if (lines.length > 0) {\r\n      lines.push('')\r\n    }\r\n\r\n    // 构建信息\r\n    lines.push(`Built with: ${bundler}${bundlerVersion ? ` v${bundlerVersion}` : ''}`)\r\n    lines.push(`Build time: ${this.formatBuildTime(buildTime)}`)\r\n    lines.push(`Build mode: ${buildMode}`)\r\n    lines.push(`Minified: ${minified ? 'Yes' : 'No'}`)\r\n\r\n    // 自定义信息\r\n    if (Object.keys(customInfo).length > 0) {\r\n      lines.push('')\r\n      Object.entries(customInfo).forEach(([key, value]) => {\r\n        lines.push(`${key}: ${value}`)\r\n      })\r\n    }\r\n\r\n    const maxLength = Math.max(...lines.map(line => line.length))\r\n    const border = '='.repeat(maxLength + 4)\r\n\r\n    return [\r\n      `/*!`,\r\n      ` * ${border}`,\r\n      ...lines.map(line => line ? ` * ${line.padEnd(maxLength)} *` : ` * ${' '.repeat(maxLength)} *`),\r\n      ` * ${border}`,\r\n      ` */`\r\n    ].join('\\n')\r\n  }\r\n\r\n  /**\r\n   * 获取正确的构建时间（修复系统时间错误）\r\n   */\r\n  private static getCorrectBuildTime(): Date {\r\n    const now = new Date()\r\n    const year = now.getFullYear()\r\n\r\n    // 如果系统时间显示 2025 年或更晚，很可能是系统时间错误\r\n    // 将其修正为 2024 年\r\n    if (year >= 2025) {\r\n      const correctedDate = new Date(now)\r\n      correctedDate.setFullYear(2024)\r\n      return correctedDate\r\n    }\r\n\r\n    return now\r\n  }\r\n\r\n  /**\r\n   * 格式化构建时间为友好格式\r\n   */\r\n  private static formatBuildTime(date: Date): string {\r\n    const year = date.getFullYear()\r\n    const month = String(date.getMonth() + 1).padStart(2, '0')\r\n    const day = String(date.getDate()).padStart(2, '0')\r\n    const hours = String(date.getHours()).padStart(2, '0')\r\n    const minutes = String(date.getMinutes()).padStart(2, '0')\r\n    const seconds = String(date.getSeconds()).padStart(2, '0')\r\n\r\n    return `${year}-${month}-${day} ${hours}:${minutes}:${seconds}`\r\n  }\r\n\r\n  /**\r\n   * 从 package.json 获取项目信息\r\n   */\r\n  static async getProjectInfo(packageJsonPath?: string): Promise<Partial<BannerOptions>> {\r\n    try {\r\n      const pkgPath = packageJsonPath || path.resolve(process.cwd(), 'package.json')\r\n      const packageJson = JSON.parse(await fs.promises.readFile(pkgPath, 'utf-8'))\r\n\r\n      return {\r\n        projectName: packageJson.name,\r\n        projectVersion: packageJson.version,\r\n        projectDescription: packageJson.description,\r\n        projectAuthor: typeof packageJson.author === 'string'\r\n          ? packageJson.author\r\n          : packageJson.author?.name,\r\n        projectLicense: packageJson.license\r\n      }\r\n    } catch (error) {\r\n      return {}\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 获取打包工具版本\r\n   */\r\n  static async getBundlerVersion(bundler: string): Promise<string | undefined> {\r\n    try {\r\n      const packagePath = path.resolve(process.cwd(), 'node_modules', bundler, 'package.json')\r\n      const packageJson = JSON.parse(await fs.promises.readFile(packagePath, 'utf-8'))\r\n      return packageJson.version\r\n    } catch (error) {\r\n      return undefined\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 创建 Rollup banner 函数\r\n   */\r\n  static createRollupBanner(options: Partial<BannerOptions> = {}): () => Promise<string> {\r\n    return async () => {\r\n      const projectInfo = await this.getProjectInfo()\r\n      const bundlerVersion = await this.getBundlerVersion('rollup')\r\n\r\n      const bannerOptions: BannerOptions = {\r\n        bundler: 'Rollup',\r\n        bundlerVersion,\r\n        buildTime: this.getCorrectBuildTime(),\r\n        ...projectInfo,\r\n        ...options\r\n      }\r\n\r\n      return this.generate(bannerOptions)\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 创建 Rolldown banner 函数\r\n   */\r\n  static createRolldownBanner(options: Partial<BannerOptions> = {}): () => Promise<string> {\r\n    return async () => {\r\n      const projectInfo = await this.getProjectInfo()\r\n      const bundlerVersion = await this.getBundlerVersion('rolldown')\r\n\r\n      const bannerOptions: BannerOptions = {\r\n        bundler: 'Rolldown',\r\n        bundlerVersion,\r\n        buildTime: this.getCorrectBuildTime(),\r\n        ...projectInfo,\r\n        ...options\r\n      }\r\n\r\n      return this.generate(bannerOptions)\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 创建通用 banner 函数\r\n   */\r\n  static createBanner(bundler: string, options: Partial<BannerOptions> = {}): () => Promise<string> {\r\n    return async () => {\r\n      const projectInfo = await this.getProjectInfo()\r\n      const bundlerVersion = await this.getBundlerVersion(bundler)\r\n\r\n      const bannerOptions: BannerOptions = {\r\n        bundler: bundler.charAt(0).toUpperCase() + bundler.slice(1),\r\n        bundlerVersion,\r\n        buildTime: this.getCorrectBuildTime(),\r\n        ...projectInfo,\r\n        ...options\r\n      }\r\n\r\n      return this.generate(bannerOptions)\r\n    }\r\n  }\r\n}\r\n"]}