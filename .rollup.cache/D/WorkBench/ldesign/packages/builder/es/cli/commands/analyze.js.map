{"version":3,"file":"analyze.js","sourceRoot":"","sources":["../../../src/cli/commands/analyze.ts"],"names":[],"mappings":"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","sourcesContent":["/**\n * 分析命令实现\n */\n\nimport { Command } from 'commander'\nimport path from 'path'\nimport { promises as fs } from 'fs'\nimport { existsSync } from 'fs'\nimport { logger } from '../../utils/logger'\nimport { formatFileSize } from '../../utils/format-utils'\n\ninterface AnalyzeOptions {\n  report?: string\n  output?: string\n  format?: 'md' | 'html'\n  open?: boolean\n  compare?: string\n}\n\nexport const analyzeCommand = new Command('analyze')\n  .description('分析构建结果（读取 build-report.json 并输出 Markdown/HTML 报告）')\n  .option('-r, --report <file>', '指定输入的构建报告 JSON，默认 dist/build-report.json')\n  .option('-o, --output <file>', '指定输出文件，默认与输入同目录下的 build-report.md 或 .html')\n  .option('-f, --format <format>', '输出格式：md|html（默认 md）', 'md')\n  .option('--compare <file>', '与另一份报告比较，生成差异分析（当前 - 基线）')\n  .option('--open', '输出 HTML 后自动在系统默认浏览器中打开')\n  .action(async (options: AnalyzeOptions) => {\n    try {\n      const reportPath = resolveReportPath(options.report)\n      const report = await loadReport(reportPath)\n\n      if (options.compare) {\n        const baselinePath = path.resolve(process.cwd(), options.compare)\n        const baseline = await loadReport(baselinePath)\n        if (options.format === 'html') {\n          const html = renderHTMLDiff(report, baseline, { currentLabel: path.basename(reportPath), baselineLabel: path.basename(baselinePath) })\n          const outPath = options.output && options.output.trim()\n            ? path.resolve(process.cwd(), options.output)\n            : path.join(path.dirname(reportPath), 'build-report-diff.html')\n          await fs.mkdir(path.dirname(outPath), { recursive: true })\n          await fs.writeFile(outPath, html, 'utf8')\n          logger.success(`差异 HTML 报告已输出: ${outPath}`)\n          if (options.open) await openInBrowser(outPath)\n        } else {\n          const md = renderMarkdownDiff(report, baseline, { currentLabel: path.basename(reportPath), baselineLabel: path.basename(baselinePath) })\n          const outPath = options.output && options.output.trim()\n            ? path.resolve(process.cwd(), options.output)\n            : path.join(path.dirname(reportPath), 'build-report-diff.md')\n          await fs.mkdir(path.dirname(outPath), { recursive: true })\n          await fs.writeFile(outPath, md, 'utf8')\n          logger.success(`差异 Markdown 报告已输出: ${outPath}`)\n        }\n        return\n      }\n\n      if (options.format === 'html') {\n        const html = renderHTML(report)\n        const outPath = resolveOutputPath(reportPath, options.output, 'html')\n        await fs.mkdir(path.dirname(outPath), { recursive: true })\n        await fs.writeFile(outPath, html, 'utf8')\n\n        logger.success(`分析 HTML 报告已输出: ${outPath}`)\n        if (options.open) await openInBrowser(outPath)\n      } else {\n        const md = renderMarkdown(report)\n        const outPath = resolveOutputPath(reportPath, options.output, 'md')\n        await fs.mkdir(path.dirname(outPath), { recursive: true })\n        await fs.writeFile(outPath, md, 'utf8')\n        logger.success(`分析 Markdown 报告已输出: ${outPath}`)\n      }\n    } catch (err) {\n      logger.error('分析失败:', err)\n      process.exit(1)\n    }\n  })\n\nfunction resolveReportPath(input?: string): string {\n  if (input && input.trim()) return path.resolve(process.cwd(), input)\n  const fallback = path.resolve(process.cwd(), 'dist', 'build-report.json')\n  if (existsSync(fallback)) return fallback\n  throw new Error('未指定 --report 且未找到 dist/build-report.json，请先执行 `build --report`')\n}\n\nasync function loadReport(file: string): Promise<any> {\n  const text = await fs.readFile(file, 'utf8')\n  return JSON.parse(text)\n}\n\nfunction formatMs(ms: any): string {\n  const n = typeof ms === 'number' ? ms : Number(ms)\n  if (!isFinite(n) || n < 0) return '-'\n  const parts: string[] = []\n  const d = Math.floor(n / 86400000)\n  const h = Math.floor((n % 86400000) / 3600000)\n  const m = Math.floor((n % 3600000) / 60000)\n  const s = Math.floor((n % 60000) / 1000)\n  const r = Math.floor(n % 1000)\n  if (d) parts.push(`${d}d`)\n  if (h) parts.push(`${h}h`)\n  if (m) parts.push(`${m}m`)\n  if (s) parts.push(`${s}s`)\n  if (!parts.length) parts.push(`${r}ms`)\n  return parts.join(' ')\n}\n\n\nfunction renderMarkdown(report: any): string {\n  const { meta = {}, totals = {}, files = [] } = report || {}\n  const lines: string[] = []\n  lines.push(`# 构建分析报告`)\n  lines.push('')\n  lines.push(`- 打包器: ${meta.bundler || '-'}  `)\n  lines.push(`- 模式: ${meta.mode || '-'}  `)\n  if (meta.duration) lines.push(`- 耗时: ${formatMs(meta.duration)}  `)\n  lines.push(`- 时间: ${new Date(meta.timestamp || Date.now()).toLocaleString()}  `)\n  if (meta.cache) {\n    lines.push('')\n    lines.push('## 缓存')\n    lines.push('')\n    lines.push(`- 启用: ${meta.cache.enabled ? '是' : '否'}  `)\n    if (typeof meta.cache.hit === 'boolean') lines.push(`- 命中: ${meta.cache.hit ? '是' : '否'}  `)\n    if (typeof meta.cache.lookupMs === 'number') lines.push(`- 查询耗时: ${formatMs(meta.cache.lookupMs)}  `)\n    if (typeof meta.cache.savedMs === 'number') lines.push(`- 预计节省: ${formatMs(meta.cache.savedMs)}  `)\n    if (meta.cache.dir) lines.push(`- 目录: ${meta.cache.dir}  `)\n    if (typeof meta.cache.ttl === 'number') lines.push(`- TTL: ${formatMs(meta.cache.ttl)}  `)\n    if (typeof meta.cache.maxSize === 'number') lines.push(`- 最大体积: ${formatFileSize(meta.cache.maxSize)}  `)\n  }\n  lines.push('')\n\n  lines.push(`## 总览`)\n  lines.push('')\n  lines.push(`- 文件数: ${totals.fileCount ?? files.length}`)\n  if (typeof totals.raw === 'number') lines.push(`- 原始大小: ${formatFileSize(totals.raw)}`)\n  if (typeof totals.gzip === 'number') lines.push(`- Gzip: ${formatFileSize(totals.gzip)}`)\n  lines.push('')\n\n  // Top 10 by gzip/raw\n  const sorted = [...files].sort((a, b) => (b.gzipSize || b.size || 0) - (a.gzipSize || a.size || 0))\n  const top = sorted.slice(0, 10)\n  if (top.length) {\n    lines.push('## Top 文件 (按 gzip 优先)')\n    lines.push('')\n    for (const f of top) {\n      lines.push(`- ${f.fileName}${f.format ? ` (${f.format})` : ''}: ${formatFileSize(f.gzipSize || f.size)} `)\n    }\n    lines.push('')\n  }\n\n  // Files table\n  lines.push('## 所有产物')\n  lines.push('')\n  lines.push('| 文件 | 格式 | 原始 | gzip | 类型 |')\n  lines.push('| --- | --- | ---: | ---: | --- |')\n  for (const f of files) {\n    lines.push(`| ${f.fileName} | ${f.format || ''} | ${formatFileSize(f.size || 0)} | ${f.gzipSize ? formatFileSize(f.gzipSize) : '-'} | ${f.type || ''} |`)\n  }\n\n  return lines.join('\\n')\n}\n\nfunction renderHTML(report: any): string {\n  const { meta = {}, totals = {}, files = [] } = report || {}\n  const rows = files.map((f: any) => `\n    <tr>\n      <td>${escapeHtml(f.fileName)}</td>\n      <td>${escapeHtml(f.format || '')}</td>\n      <td style=\"text-align:right\">${escapeHtml(formatFileSize(f.size || 0))}</td>\n      <td style=\"text-align:right\">${f.gzipSize ? escapeHtml(formatFileSize(f.gzipSize)) : '-'}</td>\n      <td>${escapeHtml(f.type || '')}</td>\n    </tr>`).join('\\n')\n\n  const top = [...files].sort((a, b) => (b.gzipSize || b.size || 0) - (a.gzipSize || a.size || 0)).slice(0, 10)\n  const topLis = top.map((f: any) => `<li>${escapeHtml(f.fileName)}${f.format ? ` (${escapeHtml(f.format)})` : ''}: ${escapeHtml(formatFileSize(f.gzipSize || f.size))}</li>`).join('\\n')\n\n  return `<!doctype html>\n<html>\n<head>\n  <meta charset=\"utf-8\" />\n  <title>构建分析报告</title>\n  <style>\n    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,Apple Color Emoji,Segoe UI Emoji; padding:24px;}\n    h1,h2{margin:0 0 12px}\n    table{border-collapse:collapse;width:100%;margin:12px 0}\n    th,td{border:1px solid #ddd;padding:8px}\n    th{background:#fafafa;text-align:left}\n    code{background:#f5f5f5;padding:2px 4px;border-radius:4px}\n    .kv{display:grid;grid-template-columns:120px 1fr;gap:6px 12px;max-width:760px}\n    .muted{color:#666}\n    .bars{max-width:960px}\n    .bar-row{display:flex;align-items:center;gap:10px;margin:6px 0}\n    .bar-label{flex:0 0 320px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}\n    .bar{flex:1;background:#f1f3f5;height:10px;border-radius:5px;position:relative}\n    .bar-inner{height:100%;background:#4F46E5;border-radius:5px}\n    .bar-val{flex:0 0 110px;text-align:right;color:#555;font-variant-numeric:tabular-nums}\n    .diff-bars{max-width:960px;margin:16px 0}\n    .diff-bar-row{display:flex;align-items:center;gap:10px;margin:8px 0}\n    .diff-bar-label{flex:0 0 280px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;font-size:14px}\n    .diff-bar{flex:1;height:12px;position:relative;background:#f8f9fa;border-radius:6px}\n    .diff-bar-positive{background:#10b981;border-radius:6px;height:100%}\n    .diff-bar-negative{background:#ef4444;border-radius:6px;height:100%}\n    .diff-bar-val{flex:0 0 120px;text-align:right;color:#555;font-variant-numeric:tabular-nums;font-size:14px}\n    .summary-bars{max-width:600px;margin:16px 0}\n    .summary-bar-row{display:flex;align-items:center;gap:12px;margin:10px 0}\n    .summary-bar-label{flex:0 0 140px;font-weight:500}\n    .summary-bar{flex:1;height:16px;position:relative;background:#f1f3f5;border-radius:8px}\n    .summary-bar-inner{height:100%;border-radius:8px}\n  </style>\n</head>\n<body>\n  <h1>构建分析报告</h1>\n  <p>\n    <strong>打包器:</strong> <code>${escapeHtml(meta.bundler || '-')}</code>\n    &nbsp;&nbsp;<strong>模式:</strong> <code>${escapeHtml(meta.mode || '-')}</code>\n    &nbsp;&nbsp;<strong>耗时:</strong> <code>${escapeHtml(formatMs(meta.duration))}</code>\n    &nbsp;&nbsp;<strong>时间:</strong> <code>${new Date(meta.timestamp || Date.now()).toLocaleString()}</code>\n  </p>\n\n  ${meta.cache ? `\n  <h2>缓存</h2>\n  <div class=\"kv\">\n    <div class=\"muted\">启用</div><div>${meta.cache.enabled ? '是' : '否'}</div>\n    ${typeof meta.cache.hit === 'boolean' ? `<div class=\"muted\">命中</div><div>${meta.cache.hit ? '是' : '否'}</div>` : ''}\n    ${typeof meta.cache.lookupMs === 'number' ? `<div class=\"muted\">查询耗时</div><div>${escapeHtml(formatMs(meta.cache.lookupMs))}</div>` : ''}\n    ${typeof meta.cache.savedMs === 'number' ? `<div class=\"muted\">预估节省</div><div>${escapeHtml(formatMs(meta.cache.savedMs))}</div>` : ''}\n    ${meta.cache.dir ? `<div class=\"muted\">目录</div><div><code>${escapeHtml(meta.cache.dir)}</code></div>` : ''}\n    ${typeof meta.cache.ttl === 'number' ? `<div class=\"muted\">TTL</div><div>${escapeHtml(formatMs(meta.cache.ttl))}</div>` : ''}\n    ${typeof meta.cache.maxSize === 'number' ? `<div class=\"muted\">最大体积</div><div>${escapeHtml(formatFileSize(meta.cache.maxSize))}</div>` : ''}\n  </div>\n  ` : ''}\n\n  <h2>总览</h2>\n  <ul>\n    <li>文件数: ${totals.fileCount ?? files.length}</li>\n    ${typeof totals.raw === 'number' ? `<li>原始大小: ${escapeHtml(formatFileSize(totals.raw))}</li>` : ''}\n    ${typeof totals.gzip === 'number' ? `<li>Gzip: ${escapeHtml(formatFileSize(totals.gzip))}</li>` : ''}\n  </ul>\n\n  ${top.length ? `<h2>Top 文件 (按 gzip 优先)</h2><ul>${topLis}</ul>` : ''}\n  ${(() => { if (!top.length) return ''; const max = Math.max(...top.map(f => (f.gzipSize || f.size || 0)), 1); const bars = top.map(f => { const v = (f.gzipSize || f.size || 0); const pct = Math.max(0, Math.min(100, (v / max) * 100)); return `<div class=\\\"bar-row\\\"><div class=\\\"bar-label\\\" title=\\\"${escapeHtml(f.fileName)}\\\">${escapeHtml(f.fileName)}</div><div class=\\\"bar\\\"><div class=\\\"bar-inner\\\" style=\\\"width:${pct.toFixed(1)}%\\\"></div></div><div class=\\\"bar-val\\\">${escapeHtml(formatFileSize(v))}</div></div>` }).join('\\n'); return `<h2>Top 大小可视化</h2><div class=\\\"bars\\\">${bars}</div>` })()}\n\n  <h2>所有产物</h2>\n  <table>\n    <thead>\n      <tr><th>文件</th><th>格式</th><th style=\\\"text-align:right\\\">原始</th><th style=\\\"text-align:right\\\">gzip</th><th>类型</th></tr>\n    </thead>\n    <tbody>\n      ${rows}\n    </tbody>\n  </table>\n</body>\n</html>`\n}\n\n\n// -------- Diff helpers --------\ninterface DiffOptions { currentLabel?: string; baselineLabel?: string }\n\nfunction computeDiff(current: any, baseline: any) {\n  const cFiles: any[] = current?.files || []\n  const bFiles: any[] = baseline?.files || []\n  const cMap = new Map<string, any>(cFiles.map((f: any) => [f.fileName, f]))\n  const bMap = new Map<string, any>(bFiles.map((f: any) => [f.fileName, f]))\n\n  const common: Array<{ fileName: string; format?: string; rawDelta: number; gzipDelta: number; curr?: any; base?: any }> = []\n  const added: any[] = []\n  const removed: any[] = []\n\n  // common & added\n  for (const [name, cf] of cMap.entries()) {\n    const bf = bMap.get(name)\n    if (bf) {\n      common.push({\n        fileName: name,\n        format: cf.format || bf.format,\n        rawDelta: (cf.size || 0) - (bf.size || 0),\n        gzipDelta: (cf.gzipSize || 0) - (bf.gzipSize || 0),\n        curr: cf,\n        base: bf,\n      })\n    } else {\n      added.push(cf)\n    }\n  }\n  // removed\n  for (const [name, bf] of bMap.entries()) {\n    if (!cMap.has(name)) removed.push(bf)\n  }\n\n  const totals = {\n    rawDelta: (current?.totals?.raw || sum(cFiles, 'size')) - (baseline?.totals?.raw || sum(bFiles, 'size')),\n    gzipDelta: (current?.totals?.gzip || sum(cFiles, 'gzipSize')) - (baseline?.totals?.gzip || sum(bFiles, 'gzipSize')),\n    fileCountDelta: (current?.totals?.fileCount ?? cFiles.length) - (baseline?.totals?.fileCount ?? bFiles.length),\n  }\n\n  // sort common by abs gzipDelta desc\n  common.sort((a, b) => Math.abs((b.gzipDelta || 0)) - Math.abs((a.gzipDelta || 0)))\n\n  return { common, added, removed, totals }\n}\n\nfunction sum(arr: any[], key: string): number { return arr.reduce((n, x) => n + (x?.[key] || 0), 0) }\n\nfunction renderMarkdownDiff(current: any, baseline: any, opts: DiffOptions = {}): string {\n  const { common, added, removed, totals } = computeDiff(current, baseline)\n  const lines: string[] = []\n  lines.push(`# 构建差异报告`)\n  lines.push('')\n  lines.push(`- 当前: ${opts.currentLabel || 'current'}  `)\n  lines.push(`- 基线: ${opts.baselineLabel || 'baseline'}  `)\n  lines.push('')\n\n  lines.push(`## 总览差异`)\n  lines.push('')\n  lines.push(`- 文件数变化: ${totals.fileCountDelta >= 0 ? '+' : ''}${totals.fileCountDelta}`)\n  lines.push(`- 原始大小变化: ${formatSignedSize(totals.rawDelta)}`)\n  lines.push(`- Gzip 大小变化: ${formatSignedSize(totals.gzipDelta)}`)\n  lines.push('')\n\n  const cCache = current?.meta?.cache\n  const bCache = baseline?.meta?.cache\n  if (cCache || bCache) {\n    lines.push('## 缓存差异')\n    lines.push('')\n    if (cCache && bCache) {\n      lines.push(`- 启用: 当前 ${cCache.enabled ? '是' : '否'}，基线 ${bCache.enabled ? '是' : '否'}  `)\n      if (typeof cCache.hit === 'boolean' || typeof bCache.hit === 'boolean') {\n        lines.push(`- 命中: 当前 ${cCache?.hit ? '是' : '否'}，基线 ${bCache?.hit ? '是' : '否'}  `)\n      }\n      if (typeof cCache.lookupMs === 'number' || typeof bCache.lookupMs === 'number') {\n        const delta = (cCache?.lookupMs || 0) - (bCache?.lookupMs || 0)\n        lines.push(`- 查询耗时: 当前 ${formatMs(cCache?.lookupMs)}（Δ${formatSignedMs(delta)}，基线 ${formatMs(bCache?.lookupMs)}）  `)\n      }\n      if (typeof cCache.savedMs === 'number' || typeof bCache.savedMs === 'number') {\n        const delta = (cCache?.savedMs || 0) - (bCache?.savedMs || 0)\n        lines.push(`- 预计节省: 当前 ${formatMs(cCache?.savedMs)}（Δ${formatSignedMs(delta)}，基线 ${formatMs(bCache?.savedMs)}）  `)\n      }\n      if (typeof cCache.ttl === 'number' || typeof bCache.ttl === 'number') {\n        lines.push(`- TTL: 当前 ${formatMs(cCache?.ttl)}，基线 ${formatMs(bCache?.ttl)}  `)\n      }\n      if (typeof cCache.maxSize === 'number' || typeof bCache.maxSize === 'number') {\n        lines.push(`- 最大体积: 当前 ${formatFileSize(cCache?.maxSize || 0)}，基线 ${formatFileSize(bCache?.maxSize || 0)}  `)\n      }\n      if (cCache?.dir || bCache?.dir) {\n        lines.push(`- 目录: 当前 ${cCache?.dir || '-'}，基线 ${bCache?.dir || '-'}  `)\n      }\n    } else {\n      const cc = cCache || {}\n      const bc = bCache || {}\n      lines.push(`- 启用: 当前 ${cc.enabled ? '是' : '否'}，基线 ${bc.enabled ? '是' : '否'}  `)\n      if (typeof cc.hit === 'boolean' || typeof bc.hit === 'boolean') {\n        lines.push(`- 命中: 当前 ${cc?.hit ? '是' : '否'}，基线 ${bc?.hit ? '是' : '否'}  `)\n      }\n      if (typeof cc.lookupMs === 'number' || typeof bc.lookupMs === 'number') {\n        lines.push(`- 查询耗时: 当前 ${formatMs(cc?.lookupMs)}，基线 ${formatMs(bc?.lookupMs)}  `)\n      }\n      if (typeof cc.savedMs === 'number' || typeof bc.savedMs === 'number') {\n        lines.push(`- 预计节省: 当前 ${formatMs(cc?.savedMs)}，基线 ${formatMs(bc?.savedMs)}  `)\n      }\n      if (typeof cc.ttl === 'number' || typeof bc.ttl === 'number') {\n        lines.push(`- TTL: 当前 ${formatMs(cc?.ttl)}，基线 ${formatMs(bc?.ttl)}  `)\n      }\n      if (typeof cc.maxSize === 'number' || typeof bc.maxSize === 'number') {\n        lines.push(`- 最大体积: 当前 ${formatFileSize(cc?.maxSize || 0)}，基线 ${formatFileSize(bc?.maxSize || 0)}  `)\n      }\n      if (cc?.dir || bc?.dir) {\n        lines.push(`- 目录: 当前 ${cc?.dir || '-'}，基线 ${bc?.dir || '-'}  `)\n      }\n    }\n    lines.push('')\n  }\n\n  if (common.length) {\n    lines.push('## 共同文件变化（按 |Δgzip| 降序）')\n    lines.push('')\n    lines.push('| 文件 | 格式 | 原始Δ | gzipΔ | 当前gzip | 基线gzip |')\n    lines.push('| --- | --- | ---: | ---: | ---: | ---: |')\n    for (const x of common.slice(0, 50)) {\n      lines.push(`| ${x.fileName} | ${x.format || ''} | ${formatSignedSize(x.rawDelta)} | ${formatSignedSize(x.gzipDelta)} | ${fmtSize(x.curr?.gzipSize)} | ${fmtSize(x.base?.gzipSize)} |`)\n    }\n    lines.push('')\n  }\n\n  if (added.length) {\n    lines.push('## 新增文件')\n    for (const f of added) {\n      lines.push(`- ${f.fileName}${f.format ? ` (${f.format})` : ''}: ${fmtSize(f.gzipSize || f.size)}`)\n    }\n    lines.push('')\n  }\n\n  if (removed.length) {\n    lines.push('## 移除文件')\n    for (const f of removed) {\n      lines.push(`- ${f.fileName}${f.format ? ` (${f.format})` : ''}: ${fmtSize(f.gzipSize || f.size)}`)\n    }\n    lines.push('')\n  }\n\n  return lines.join('\\n')\n}\n\nfunction renderHTMLDiff(current: any, baseline: any, opts: DiffOptions = {}): string {\n  const { common, added, removed, totals } = computeDiff(current, baseline)\n  const commonRows = common.slice(0, 100).map(x => `\n    <tr>\n      <td>${escapeHtml(x.fileName)}</td>\n      <td>${escapeHtml(x.format || '')}</td>\n\n      <td style=\"text-align:right\">${escapeHtml(formatSignedSize(x.rawDelta))}</td>\n      <td style=\"text-align:right\">${escapeHtml(formatSignedSize(x.gzipDelta))}</td>\n      <td style=\"text-align:right\">${escapeHtml(fmtSize(x.curr?.gzipSize))}</td>\n      <td style=\"text-align:right\">${escapeHtml(fmtSize(x.base?.gzipSize))}</td>\n    </tr>`).join('\\n')\n\n  const addedLis = added.map((f: any) => `<li>${escapeHtml(f.fileName)}${f.format ? ` (${escapeHtml(f.format)})` : ''}: ${escapeHtml(fmtSize(f.gzipSize || f.size))}</li>`).join('\\n')\n  const removedLis = removed.map((f: any) => `<li>${escapeHtml(f.fileName)}${f.format ? ` (${escapeHtml(f.format)})` : ''}: ${escapeHtml(fmtSize(f.gzipSize || f.size))}</li>`).join('\\n')\n  const cCache = current?.meta?.cache\n  const bCache = baseline?.meta?.cache\n  const cacheBlock = (cCache || bCache) ? `\n  <h2>缓存差异</h2>\n  <div class=\"kv\">\n    <div class=\"muted\">启用</div><div>当前 ${cCache?.enabled ? '是' : '否'}，基线 ${bCache?.enabled ? '是' : '否'}</div>\n    ${typeof (cCache?.hit) === 'boolean' || typeof (bCache?.hit) === 'boolean' ? `<div class=\"muted\">命中</div><div>当前 ${cCache?.hit ? '是' : '否'}，基线 ${bCache?.hit ? '是' : '否'}</div>` : ''}\n    ${typeof (cCache?.lookupMs) === 'number' || typeof (bCache?.lookupMs) === 'number' ? `<div class=\"muted\">查询耗时</div><div>当前 ${escapeHtml(formatMs(cCache?.lookupMs))}（Δ${escapeHtml(formatSignedMs((cCache?.lookupMs || 0) - (bCache?.lookupMs || 0)))}，基线 ${escapeHtml(formatMs(bCache?.lookupMs))}）</div>` : ''}\n    ${typeof (cCache?.savedMs) === 'number' || typeof (bCache?.savedMs) === 'number' ? `<div class=\"muted\">预估节省</div><div>当前 ${escapeHtml(formatMs(cCache?.savedMs))}（Δ${escapeHtml(formatSignedMs((cCache?.savedMs || 0) - (bCache?.savedMs || 0)))}，基线 ${escapeHtml(formatMs(bCache?.savedMs))}）</div>` : ''}\n    ${typeof (cCache?.ttl) === 'number' || typeof (bCache?.ttl) === 'number' ? `<div class=\"muted\">TTL</div><div>当前 ${escapeHtml(formatMs(cCache?.ttl))}，基线 ${escapeHtml(formatMs(bCache?.ttl))}</div>` : ''}\n    ${typeof (cCache?.maxSize) === 'number' || typeof (bCache?.maxSize) === 'number' ? `<div class=\"muted\">最大体积</div><div>当前 ${escapeHtml(formatFileSize(cCache?.maxSize || 0))}，基线 ${escapeHtml(formatFileSize(bCache?.maxSize || 0))}</div>` : ''}\n    ${(cCache?.dir || bCache?.dir) ? `<div class=\"muted\">目录</div><div>当前 ${escapeHtml(cCache?.dir || '-')}，基线 ${escapeHtml(bCache?.dir || '-')}</div>` : ''}\n  </div>` : ''\n\n\n  return `<!doctype html>\n<html>\n<head>\n  <meta charset=\"utf-8\" />\n  <title>构建差异报告</title>\n  <style>\n\n    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,Apple Color Emoji,Segoe UI Emoji; padding:24px;}\n    h1,h2{margin:0 0 12px}\n    table{border-collapse:collapse;width:100%;margin:12px 0}\n    th,td{border:1px solid #ddd;padding:8px}\n    th{background:#fafafa;text-align:left}\n    code{background:#f5f5f5;padding:2px 4px;border-radius:4px}\n    .kv{display:grid;grid-template-columns:160px 1fr;gap:6px 12px;max-width:920px}\n    .muted{color:#666}\n    .diff-bars{max-width:960px;margin:16px 0}\n    .diff-bar-row{display:flex;align-items:center;gap:10px;margin:8px 0}\n    .diff-bar-label{flex:0 0 280px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;font-size:14px}\n    .diff-bar{flex:1;height:12px;position:relative;background:#f8f9fa;border-radius:6px}\n    .diff-bar-positive{background:#10b981;border-radius:6px;height:100%}\n    .diff-bar-negative{background:#ef4444;border-radius:6px;height:100%}\n    .diff-bar-val{flex:0 0 120px;text-align:right;color:#555;font-variant-numeric:tabular-nums;font-size:14px}\n    .summary-bars{max-width:600px;margin:16px 0}\n    .summary-bar-row{display:flex;align-items:center;gap:12px;margin:10px 0}\n    .summary-bar-label{flex:0 0 140px;font-weight:500}\n    .summary-bar{flex:1;height:16px;position:relative;background:#f1f3f5;border-radius:8px}\n    .summary-bar-inner{height:100%;border-radius:8px}\n  </style>\n</head>\n<body>\n  <h1>构建差异报告</h1>\n  <p>\n    <strong>当前:</strong> <code>${escapeHtml(opts.currentLabel || 'current')}</code>\n    &nbsp;&nbsp;<strong>基线:</strong> <code>${escapeHtml(opts.baselineLabel || 'baseline')}</code>\n  </p>\n\n\n  ${cacheBlock}\n\n  <h2>总览差异</h2>\n\n  <ul>\n    <li>文件数变化: ${totals.fileCountDelta >= 0 ? '+' : ''}${totals.fileCountDelta}</li>\n    <li>原始大小变化: ${escapeHtml(formatSignedSize(totals.rawDelta))}</li>\n    <li>Gzip 大小变化: ${escapeHtml(formatSignedSize(totals.gzipDelta))}</li>\n  </ul>\n\n  ${(() => {\n    const maxDelta = Math.max(Math.abs(totals.rawDelta), Math.abs(totals.gzipDelta), 1)\n    const rawPct = Math.min(100, (Math.abs(totals.rawDelta) / maxDelta) * 100)\n    const gzipPct = Math.min(100, (Math.abs(totals.gzipDelta) / maxDelta) * 100)\n    const rawColor = totals.rawDelta >= 0 ? '#10b981' : '#ef4444'\n    const gzipColor = totals.gzipDelta >= 0 ? '#10b981' : '#ef4444'\n    return `<h3>大小变化可视化</h3>\n    <div class=\"summary-bars\">\n      <div class=\"summary-bar-row\">\n        <div class=\"summary-bar-label\">原始大小</div>\n        <div class=\"summary-bar\">\n          <div class=\"summary-bar-inner\" style=\"width:${rawPct.toFixed(1)}%;background:${rawColor}\"></div>\n        </div>\n        <div class=\"diff-bar-val\">${escapeHtml(formatSignedSize(totals.rawDelta))}</div>\n      </div>\n      <div class=\"summary-bar-row\">\n        <div class=\"summary-bar-label\">Gzip 大小</div>\n        <div class=\"summary-bar\">\n          <div class=\"summary-bar-inner\" style=\"width:${gzipPct.toFixed(1)}%;background:${gzipColor}\"></div>\n        </div>\n        <div class=\"diff-bar-val\">${escapeHtml(formatSignedSize(totals.gzipDelta))}</div>\n      </div>\n    </div>`\n  })()}\n\n  ${common.length ? `<h2>共同文件变化（按 |Δgzip| 降序）</h2>\n  <table>\n    <thead>\n      <tr><th>文件</th><th>格式</th><th style=\"text-align:right\">原始Δ</th><th style=\"text-align:right\">gzipΔ</th><th style=\"text-align:right\">当前gzip</th><th style=\"text-align:right\">基线gzip</th></tr>\n    </thead>\n    <tbody>\n      ${commonRows}\n    </tbody>\n  </table>\n  ${(() => {\n    const topChanges = common.slice(0, 10)\n    if (!topChanges.length) return ''\n    const maxDelta = Math.max(...topChanges.map(f => Math.abs(f.gzipDelta || 0)), 1)\n    const bars = topChanges.map(f => {\n      const delta = f.gzipDelta || 0\n      const pct = Math.min(100, (Math.abs(delta) / maxDelta) * 100)\n      // const color = delta >= 0 ? '#10b981' : '#ef4444' // 暂时不需要\n      return `<div class=\"diff-bar-row\">\n        <div class=\"diff-bar-label\" title=\"${escapeHtml(f.fileName)}\">${escapeHtml(f.fileName)}</div>\n        <div class=\"diff-bar\">\n          <div class=\"${delta >= 0 ? 'diff-bar-positive' : 'diff-bar-negative'}\" style=\"width:${pct.toFixed(1)}%\"></div>\n        </div>\n        <div class=\"diff-bar-val\">${escapeHtml(formatSignedSize(delta))}</div>\n      </div>`\n    }).join('\\n')\n    return `<h3>Top 变化可视化</h3><div class=\"diff-bars\">${bars}</div>`\n  })()}` : ''}\n\n  ${added.length ? `<h2>新增文件</h2><ul>${addedLis}</ul>\n  ${(() => {\n    const sortedAdded = [...added].sort((a, b) => (b.gzipSize || b.size || 0) - (a.gzipSize || a.size || 0)).slice(0, 10)\n    if (!sortedAdded.length) return ''\n    const maxSize = Math.max(...sortedAdded.map(f => (f.gzipSize || f.size || 0)), 1)\n    const bars = sortedAdded.map(f => {\n      const size = f.gzipSize || f.size || 0\n      const pct = Math.min(100, (size / maxSize) * 100)\n      return `<div class=\"diff-bar-row\">\n        <div class=\"diff-bar-label\" title=\"${escapeHtml(f.fileName)}\">${escapeHtml(f.fileName)}</div>\n        <div class=\"diff-bar\">\n          <div class=\"diff-bar-positive\" style=\"width:${pct.toFixed(1)}%\"></div>\n        </div>\n        <div class=\"diff-bar-val\">${escapeHtml(formatFileSize(size))}</div>\n      </div>`\n    }).join('\\n')\n    return `<h3>新增文件大小可视化</h3><div class=\"diff-bars\">${bars}</div>`\n  })()}` : ''}\n  ${removed.length ? `<h2>移除文件</h2><ul>${removedLis}</ul>\n  ${(() => {\n    const sortedRemoved = [...removed].sort((a, b) => (b.gzipSize || b.size || 0) - (a.gzipSize || a.size || 0)).slice(0, 10)\n    if (!sortedRemoved.length) return ''\n    const maxSize = Math.max(...sortedRemoved.map(f => (f.gzipSize || f.size || 0)), 1)\n    const bars = sortedRemoved.map(f => {\n      const size = f.gzipSize || f.size || 0\n      const pct = Math.min(100, (size / maxSize) * 100)\n      return `<div class=\"diff-bar-row\">\n        <div class=\"diff-bar-label\" title=\"${escapeHtml(f.fileName)}\">${escapeHtml(f.fileName)}</div>\n        <div class=\"diff-bar\">\n          <div class=\"diff-bar-negative\" style=\"width:${pct.toFixed(1)}%\"></div>\n        </div>\n        <div class=\"diff-bar-val\">${escapeHtml(formatFileSize(size))}</div>\n      </div>`\n    }).join('\\n')\n    return `<h3>移除文件大小可视化</h3><div class=\"diff-bars\">${bars}</div>`\n  })()}` : ''}\n</body>\n</html>`\n}\n\nfunction fmtSize(n?: number): string { return typeof n === 'number' && n >= 0 ? formatFileSize(n) : '-' }\nfunction formatSignedSize(delta: number): string {\n  const sign = delta > 0 ? '+' : ''\n  return `${sign}${formatFileSize(Math.abs(delta))}`\n}\n\nfunction formatSignedMs(delta: number): string {\n  const sign = delta > 0 ? '+' : ''\n  return `${sign}${formatMs(Math.abs(delta))}`\n}\n\nfunction escapeHtml(s: any): string {\n  return String(s)\n    .replace(/&/g, '&amp;')\n    .replace(/</g, '&lt;')\n    .replace(/>/g, '&gt;')\n    .replace(/\"/g, '&quot;')\n    .replace(/'/g, '&#39;')\n}\n\nfunction resolveOutputPath(reportPath: string, output: string | undefined, ext: 'md' | 'html'): string {\n  if (output && output.trim()) return path.resolve(process.cwd(), output)\n  const dir = path.dirname(reportPath)\n  return path.join(dir, `build-report.${ext}`)\n}\n\nasync function openInBrowser(filePath: string): Promise<void> {\n  const { exec } = await import('child_process')\n  const abs = path.resolve(filePath)\n  const cmd = process.platform === 'win32' ? `start \"\" \"${abs}\"`\n    : process.platform === 'darwin' ? `open \"${abs}\"`\n    : `xdg-open \"${abs}\"`\n  await new Promise<void>((resolve, reject) => {\n    exec(cmd, (err) => err ? reject(err) : resolve())\n  })\n}\n"]}