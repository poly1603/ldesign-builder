# ğŸ—ºï¸ tools/builder é‡æ„è·¯çº¿å›¾

> **å¿«é€Ÿå‚è€ƒ**: æœ¬æ–‡æ¡£æ˜¯ [ARCHITECTURE_ANALYSIS_REPORT.md](./ARCHITECTURE_ANALYSIS_REPORT.md) çš„æ‰§è¡Œæ‘˜è¦

---

## ğŸ“Š ä¸€å¥è¯æ€»ç»“

**é€šè¿‡åˆ é™¤ 40-45% çš„å†—ä½™ä»£ç å’Œé‡æ„æ ¸å¿ƒæ¨¡å—ï¼Œå°† builder ä» 184 ä¸ªæ–‡ä»¶ä¼˜åŒ–åˆ° ~100 ä¸ªæ–‡ä»¶ï¼Œæå‡ 20% æ„å»ºé€Ÿåº¦ï¼Œé™ä½ 60% ç»´æŠ¤æˆæœ¬ã€‚**

---

## ğŸ¯ æ ¸å¿ƒç›®æ ‡

| æŒ‡æ ‡ | å½“å‰ | ç›®æ ‡ | æ”¹è¿› |
|------|------|------|------|
| æ–‡ä»¶æ•°é‡ | 184 | ~100 | â¬‡ï¸ 45% |
| ä»£ç è¡Œæ•° | ~50,000 | ~30,000 | â¬‡ï¸ 40% |
| æ‰“åŒ…ä½“ç§¯ | åŸºå‡† | åŸºå‡† -40% | â¬‡ï¸ 40% |
| æ„å»ºé€Ÿåº¦ | åŸºå‡† | åŸºå‡† +20% | â¬†ï¸ 20% |
| ç»´æŠ¤æˆæœ¬ | åŸºå‡† | åŸºå‡† -60% | â¬‡ï¸ 60% |

---

## ğŸš€ å››é˜¶æ®µå®æ–½è®¡åˆ’

### ç¬¬ä¸€é˜¶æ®µï¼šå¿«é€Ÿæ¸…ç†ï¼ˆ1 å‘¨ï¼‰

**åˆ é™¤æœªä½¿ç”¨åŠŸèƒ½**

```bash
# åˆ é™¤è¿™äº›ç›®å½•
rm -rf src/ai/              # AI ä¼˜åŒ–å™¨ï¼ˆæœªå®ç°ï¼‰
rm -rf src/cdn/             # CDN ä¼˜åŒ–å™¨ï¼ˆè¶…å‡ºèŒè´£ï¼‰
rm -rf src/ci/              # CI é›†æˆï¼ˆåº”ç”± CI å·¥å…·å¤„ç†ï¼‰
rm -rf src/plugin-market/   # æ’ä»¶å¸‚åœºï¼ˆæœªå®ç°ï¼‰
rm -rf src/runtimes/        # è¿è¡Œæ—¶æ”¯æŒï¼ˆä¸åº”åœ¨æ„å»ºå·¥å…·ä¸­ï¼‰
rm -rf src/debugger/        # è°ƒè¯•å™¨ï¼ˆå¯èƒ½æœªä½¿ç”¨ï¼‰
rm -rf src/visualize/       # é‡å¤çš„å¯è§†åŒ–ç›®å½•
rm -rf src/visualizer/      # é‡å¤çš„å¯è§†åŒ–ç›®å½•
rm -rf src/monitor/         # é‡å¤çš„ç›‘æ§ç›®å½•
rm -rf src/monitoring/      # é‡å¤çš„ç›‘æ§ç›®å½•
```

**æ”¶ç›Š**: 
- âœ… ä»£ç å‡å°‘ ~3,500 è¡Œ
- âœ… æ‰“åŒ…ä½“ç§¯å‡å°‘ ~15%
- âœ… æ—¶é—´: 5 å°æ—¶

---

### ç¬¬äºŒé˜¶æ®µï¼šåˆå¹¶é‡å¤åŠŸèƒ½ï¼ˆ2-3 å‘¨ï¼‰

**ç»Ÿä¸€ 5 å¤§ç³»ç»Ÿ**

1. **ç¼“å­˜ç³»ç»Ÿ** (5ä¸ª â†’ 1ä¸ª)
   - ä¿ç•™: `cache.ts`ï¼ˆRollup ä¸“ç”¨ï¼‰
   - åˆ é™¤: `cache-manager.ts`, `build-cache-manager.ts`, `BuildCache.ts`, `DistributedCache.ts`
   - åˆ›å»º: `cache/UnifiedCacheManager.ts`

2. **å†…å­˜ç®¡ç†** (4ä¸ª â†’ 1ä¸ª)
   - åˆå¹¶: `memory-manager.ts`, `memory-optimizer.ts` (2ä¸ª), `memory-leak-detector.ts`
   - åˆ›å»º: `memory/MemoryManager.ts`

3. **é…ç½®ç³»ç»Ÿ** (9ä¸ª â†’ 3ä¸ª)
   - ä¿ç•™: `zod-schema.ts`, `minimal-config.ts`
   - åˆ é™¤: `simple-config.ts`, `enhanced-config.ts`
   - åˆ›å»º: `config/ConfigSystem.ts`

4. **æ€§èƒ½å·¥å…·** (4ä¸ª â†’ 2ä¸ª)
   - åˆå¹¶åˆ°: `performance/PerformanceMonitor.ts`, `performance/PerformanceUtils.ts`

5. **å¹¶è¡Œå¤„ç†** (3ä¸ª â†’ 1ä¸ª)
   - ç»Ÿä¸€åˆ°: `parallel/ParallelExecutor.ts`

**æ”¶ç›Š**:
- âœ… ä»£ç å‡å°‘ ~5,000 è¡Œ
- âœ… API ç»Ÿä¸€
- âœ… æ—¶é—´: 42 å°æ—¶

---

### ç¬¬ä¸‰é˜¶æ®µï¼šé‡æ„æ ¸å¿ƒæ¨¡å—ï¼ˆ3-4 å‘¨ï¼‰

**æ‹†åˆ†è¿‡å¤§æ–‡ä»¶**

1. **RollupAdapter** (2,081è¡Œ â†’ 500è¡Œ)
   ```
   RollupAdapter.ts (2,081è¡Œ)
   â†“ æ‹†åˆ†ä¸º
   â”œâ”€â”€ RollupAdapter.ts      (~500è¡Œ) - ä¸»é€‚é…å™¨
   â”œâ”€â”€ ConfigBuilder.ts      (~300è¡Œ) - é…ç½®æ„å»º
   â”œâ”€â”€ PluginResolver.ts     (~200è¡Œ) - æ’ä»¶è§£æ
   â””â”€â”€ OutputGenerator.ts    (~200è¡Œ) - è¾“å‡ºç”Ÿæˆ
   ```

2. **åˆ é™¤ EnhancedRollupAdapter** (1,350è¡Œ)
   - åŠŸèƒ½åˆå¹¶åˆ°ä¸»é€‚é…å™¨

3. **åˆå¹¶éªŒè¯å™¨**
   - `EnhancedPostBuildValidator` (1,705è¡Œ) + `PostBuildValidator` (400è¡Œ)
   - â†’ `PostBuildValidator` (~600è¡Œ)

4. **ä¼˜åŒ–æ ¸å¿ƒæ„å»ºå™¨**
   - `LibraryBuilder.ts` (842è¡Œ â†’ ~500è¡Œ)
   - `LibraryDetector.ts` (809è¡Œ â†’ ~400è¡Œ)

**æ”¶ç›Š**:
- âœ… ä»£ç å‡å°‘ ~4,000 è¡Œ
- âœ… æ–‡ä»¶å¤§å°åˆç†åŒ–
- âœ… æ—¶é—´: 54 å°æ—¶

---

### ç¬¬å››é˜¶æ®µï¼šä¼˜åŒ–å’Œå®Œå–„ï¼ˆ2 å‘¨ï¼‰

**ç®€åŒ–å¯¼å‡ºå’Œç±»å‹**

1. **åˆ†å±‚å¯¼å‡º**
   ```typescript
   // src/index.ts - æ ¸å¿ƒ API
   export { LibraryBuilder, defineConfig }
   
   // src/advanced.ts - é«˜çº§ API
   export { MemoryManager, CacheManager }
   
   // src/plugins.ts - æ’ä»¶ API
   export { tailwindPlugin, cssInJSPlugin }
   ```

2. **ä¼˜åŒ–ç±»å‹ç³»ç»Ÿ**
   - è§£å†³ç±»å‹å†²çª
   - ç»Ÿä¸€ç±»å‹å®šä¹‰
   - å®Œå–„ JSDoc

3. **å®Œå–„æ–‡æ¡£**
   - æ›´æ–° API æ–‡æ¡£
   - æ·»åŠ è¿ç§»æŒ‡å—
   - æ·»åŠ ä½¿ç”¨ç¤ºä¾‹

**æ”¶ç›Š**:
- âœ… æ›´å¥½çš„ Tree-shaking
- âœ… æ›´å°çš„æ‰“åŒ…ä½“ç§¯
- âœ… æ›´å¥½çš„å¼€å‘ä½“éªŒ
- âœ… æ—¶é—´: 46 å°æ—¶

---

## ğŸ“… æ—¶é—´è¡¨

| é˜¶æ®µ | æ—¶é—´ | ä»£ç å‡å°‘ | ç´¯è®¡ |
|------|------|---------|------|
| ç¬¬ä¸€é˜¶æ®µ | 1 å‘¨ | 3,500 è¡Œ | 3,500 |
| ç¬¬äºŒé˜¶æ®µ | 2-3 å‘¨ | 5,000 è¡Œ | 8,500 |
| ç¬¬ä¸‰é˜¶æ®µ | 3-4 å‘¨ | 4,000 è¡Œ | 12,500 |
| ç¬¬å››é˜¶æ®µ | 2 å‘¨ | - | 12,500 |
| **æ€»è®¡** | **8-10 å‘¨** | **12,500 è¡Œ** | **~50%** |

---

## âš ï¸ é£é™©å’Œç¼“è§£

### é«˜é£é™©

ğŸ”´ **ç ´åç°æœ‰åŠŸèƒ½**
- âœ… å®Œæ•´æµ‹è¯•è¦†ç›–ï¼ˆ> 80%ï¼‰
- âœ… æ¸è¿›å¼é‡æ„
- âœ… å‘åå…¼å®¹
- âœ… ç”¨æˆ·éªŒè¯

### ä¸­é£é™©

ğŸŸ¡ **æ€§èƒ½é€€åŒ–**
- âœ… æ€§èƒ½åŸºå‡†æµ‹è¯•
- âœ… æ€§èƒ½ç›‘æ§
- âœ… æ€§èƒ½ä¼˜åŒ–

ğŸŸ¡ **API ä¸å…¼å®¹**
- âœ… API å…¼å®¹æ€§æ£€æŸ¥
- âœ… æ¸è¿›å¼è¿ç§»
- âœ… æ–‡æ¡£æ›´æ–°

---

## âœ… æˆåŠŸæŒ‡æ ‡

- [ ] ä»£ç é‡å‡å°‘ 40-50%
- [ ] æ–‡ä»¶æ•°å‡å°‘ 45%
- [ ] æ‰“åŒ…ä½“ç§¯å‡å°‘ 40%
- [ ] æ„å»ºé€Ÿåº¦æå‡ 20%
- [ ] æµ‹è¯•è¦†ç›–ç‡ > 80%
- [ ] é›¶ TypeScript é”™è¯¯
- [ ] é›¶ ESLint é”™è¯¯
- [ ] æ–‡æ¡£è¦†ç›–ç‡ > 95%

---

## ğŸ¯ ä¸‹ä¸€æ­¥è¡ŒåŠ¨

### ç«‹å³å¼€å§‹ï¼ˆæœ¬å‘¨ï¼‰

1. **åˆ›å»ºé‡æ„åˆ†æ”¯**
   ```bash
   git checkout -b refactor/phase-1-cleanup
   ```

2. **åˆ é™¤æœªä½¿ç”¨åŠŸèƒ½**
   ```bash
   # æŒ‰ç…§ç¬¬ä¸€é˜¶æ®µæ¸…å•æ‰§è¡Œ
   ```

3. **éªŒè¯æ„å»º**
   ```bash
   pnpm build
   pnpm test
   ```

4. **æäº¤ PR**
   ```bash
   git commit -m "refactor: phase 1 - remove unused features"
   git push origin refactor/phase-1-cleanup
   ```

---

**è¯¦ç»†åˆ†æ**: æŸ¥çœ‹ [ARCHITECTURE_ANALYSIS_REPORT.md](./ARCHITECTURE_ANALYSIS_REPORT.md)  
**é—®é¢˜åé¦ˆ**: åˆ›å»º GitHub Issue  
**æ›´æ–°æ—¶é—´**: 2025-11-17

