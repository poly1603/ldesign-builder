# Builder æ•…éšœæ’æŸ¥æŒ‡å—

## æ„å»ºå¡ä½æˆ–è¶…æ—¶

### é—®é¢˜è¡¨ç°
- æ„å»ºè¿‡ç¨‹é•¿æ—¶é—´æ— å“åº”
- æ²¡æœ‰ä»»ä½•é”™è¯¯æç¤º
- è¿›åº¦æ¡ä¸€ç›´è½¬åœˆ

### å¯èƒ½åŸå› å’Œè§£å†³æ–¹æ¡ˆ

#### 1. é…ç½®æ–‡ä»¶é—®é¢˜

**æ£€æŸ¥é…ç½®æ–‡ä»¶æ˜¯å¦å­˜åœ¨**
```bash
# é…ç½®æ–‡ä»¶åº”è¯¥åœ¨ä»¥ä¸‹ä½ç½®ä¹‹ä¸€
.ldesign/builder.config.ts  # æ¨èä½ç½®
ldesign.config.ts
builder.config.ts
```

**æ£€æŸ¥é…ç½®æ–‡ä»¶è¯­æ³•**
```bash
# ä½¿ç”¨ TypeScript ç¼–è¯‘å™¨æ£€æŸ¥
npx tsc --noEmit .ldesign/builder.config.ts
```

**å¸¸è§é…ç½®é”™è¯¯**
```typescript
// âŒ é”™è¯¯ï¼šç¼ºå°‘ input
export default defineConfig({
  output: {
    format: ['esm', 'cjs']
  }
})

// âœ… æ­£ç¡®ï¼šæŒ‡å®š input
export default defineConfig({
  input: 'src/index.ts',  // å•å…¥å£
  // æˆ–
  input: {                 // å¤šå…¥å£
    index: 'src/index.ts',
    utils: 'src/utils/index.ts'
  },
  output: {
    format: ['esm', 'cjs']
  }
})
```

#### 2. å…¥å£æ–‡ä»¶ä¸å­˜åœ¨

**æ£€æŸ¥å…¥å£æ–‡ä»¶**
```bash
# ç¡®è®¤æ–‡ä»¶å­˜åœ¨
ls -la src/index.ts

# æˆ–ä½¿ç”¨ find
find . -name "index.ts"
```

**å¸¸è§è·¯å¾„é”™è¯¯**
```typescript
// âŒ é”™è¯¯ï¼šè·¯å¾„ä¸å¯¹
input: 'index.ts'           // ç¼ºå°‘ src/
input: './src/index.ts'     // ä¸éœ€è¦ ./
input: 'src/index.js'       // æ‰©å±•åé”™è¯¯

// âœ… æ­£ç¡®
input: 'src/index.ts'
```

#### 3. ä¾èµ–æœªå®‰è£…

**å®‰è£…ä¾èµ–**
```bash
# ä½¿ç”¨ pnpmï¼ˆæ¨èï¼‰
pnpm install

# æˆ–ä½¿ç”¨ npm
npm install

# æˆ–ä½¿ç”¨ yarn
yarn install
```

**æ£€æŸ¥å…³é”®ä¾èµ–**
```bash
# æ£€æŸ¥ builder æ˜¯å¦å®‰è£…
pnpm list @ldesign/builder

# æ£€æŸ¥ TypeScript æ˜¯å¦å®‰è£…
pnpm list typescript
```

#### 4. TypeScript ç¼–è¯‘é”™è¯¯

**æ£€æŸ¥ TypeScript é”™è¯¯**
```bash
# è¿è¡Œç±»å‹æ£€æŸ¥
pnpm tsc --noEmit

# æˆ–
npm run type-check
```

**å¸¸è§ TypeScript é—®é¢˜**
- ç¼ºå°‘ç±»å‹å®šä¹‰æ–‡ä»¶
- å¯¼å…¥è·¯å¾„é”™è¯¯
- ç±»å‹ä¸åŒ¹é…

#### 5. å¾ªç¯ä¾èµ–

**æ£€æŸ¥å¾ªç¯ä¾èµ–**
```bash
# ä½¿ç”¨ madge å·¥å…·
npx madge --circular src/

# æˆ–ä½¿ç”¨ dpdm
npx dpdm src/index.ts
```

**è§£å†³å¾ªç¯ä¾èµ–**
- é‡æ„ä»£ç ç»“æ„
- ä½¿ç”¨ä¾èµ–æ³¨å…¥
- å»¶è¿Ÿå¯¼å…¥

## ä½¿ç”¨è°ƒè¯•æ¨¡å¼

### å¯ç”¨è¯¦ç»†æ—¥å¿—

```bash
# ä½¿ç”¨ --debug å‚æ•°
pnpm build --debug

# æˆ–è®¾ç½®æ—¥å¿—çº§åˆ«
pnpm build --log-level debug
```

### è°ƒè¯•è¾“å‡ºè¯´æ˜

```
ğŸ”¨ å¼€å§‹æ‰“åŒ…...
ğŸ§¹ æ¸…ç†è¾“å‡ºç›®å½•...          # æ¸…ç†æ—§æ–‡ä»¶
ğŸ”„ åˆ‡æ¢æ‰“åŒ…å™¨: rollup       # ä½¿ç”¨çš„æ‰“åŒ…å·¥å…·
ğŸ” æ£€æµ‹åº“ç±»å‹...            # è‡ªåŠ¨æ£€æµ‹é¡¹ç›®ç±»å‹
ğŸ“¦ åº“ç±»å‹: typescript       # æ£€æµ‹ç»“æœ
âš™ï¸  åº”ç”¨æ„å»ºç­–ç•¥...         # åº”ç”¨å¯¹åº”ç­–ç•¥
ğŸ”¨ æ‰§è¡Œæ‰“åŒ…...              # å¼€å§‹å®é™…æ‰“åŒ…
```

## æ„å»ºè¶…æ—¶æœºåˆ¶

### é»˜è®¤è¶…æ—¶æ—¶é—´
- **é»˜è®¤**: 5 åˆ†é’Ÿï¼ˆ300 ç§’ï¼‰
- **è¿›åº¦æç¤º**: æ¯ 30 ç§’æç¤ºä¸€æ¬¡

### è¶…æ—¶æç¤ºä¿¡æ¯

```
â³ æ„å»ºè¿›è¡Œä¸­... å·²è€—æ—¶ 30s
â³ æ„å»ºè€—æ—¶è¾ƒé•¿ (1m)ï¼Œè¯·æ£€æŸ¥:
   â€¢ é…ç½®æ–‡ä»¶æ˜¯å¦æ­£ç¡® (.ldesign/builder.config.ts)
   â€¢ å…¥å£æ–‡ä»¶æ˜¯å¦å­˜åœ¨
   â€¢ ä¾èµ–æ˜¯å¦å·²å®‰è£… (pnpm install)
âš ï¸  æ„å»ºå·²è€—æ—¶ 1m 30sï¼Œå¯èƒ½å­˜åœ¨é—®é¢˜
   ä½¿ç”¨ --debug å‚æ•°æŸ¥çœ‹è¯¦ç»†ä¿¡æ¯
```

### è¶…æ—¶é”™è¯¯

å¦‚æœæ„å»ºè¶…è¿‡ 5 åˆ†é’Ÿï¼Œä¼šæ˜¾ç¤ºï¼š

```
âŒ æ„å»ºè¶…æ—¶ (è¶…è¿‡ 300 ç§’)

å¯èƒ½çš„åŸå› :
  1. é…ç½®æ–‡ä»¶æœ‰é—®é¢˜ - æ£€æŸ¥ .ldesign/builder.config.ts
  2. å…¥å£æ–‡ä»¶ä¸å­˜åœ¨ - æ£€æŸ¥ input é…ç½®
  3. ä¾èµ–æœªå®‰è£… - è¿è¡Œ pnpm install
  4. TypeScript ç¼–è¯‘é”™è¯¯ - è¿è¡Œ tsc --noEmit æ£€æŸ¥
  5. å¾ªç¯ä¾èµ– - æ£€æŸ¥æ¨¡å—å¯¼å…¥

æç¤º: ä½¿ç”¨ --debug å‚æ•°è·å–è¯¦ç»†ä¿¡æ¯
```

## é…ç½®éªŒè¯é”™è¯¯

### ç¼ºå°‘å…¥å£æ–‡ä»¶é…ç½®

```
âŒ ç¼ºå°‘å…¥å£æ–‡ä»¶é…ç½®
   éœ€è¦åœ¨é…ç½®æ–‡ä»¶ä¸­æŒ‡å®š inputï¼Œä¾‹å¦‚:
   â€¢ input: "src/index.ts"
   â€¢ input: { index: "src/index.ts", utils: "src/utils/index.ts" }
   â€¢ æˆ–åœ¨ output.esm/cjs/umd ä¸­åˆ†åˆ«æŒ‡å®š input
```

**è§£å†³æ–¹æ¡ˆ**: åœ¨é…ç½®æ–‡ä»¶ä¸­æ·»åŠ  `input` å­—æ®µ

### å…¥å£æ–‡ä»¶ä¸å­˜åœ¨

```
âŒ å…¥å£æ–‡ä»¶ä¸å­˜åœ¨: src/index.ts
   å®Œæ•´è·¯å¾„: /path/to/project/src/index.ts
   è¯·æ£€æŸ¥:
   â€¢ æ–‡ä»¶è·¯å¾„æ˜¯å¦æ­£ç¡®
   â€¢ æ–‡ä»¶æ˜¯å¦å·²åˆ›å»º
   â€¢ å·¥ä½œç›®å½•æ˜¯å¦æ­£ç¡® (cwd: /path/to/project)
```

**è§£å†³æ–¹æ¡ˆ**: 
1. åˆ›å»ºç¼ºå¤±çš„æ–‡ä»¶
2. ä¿®æ­£é…ç½®ä¸­çš„è·¯å¾„
3. æ£€æŸ¥å·¥ä½œç›®å½•æ˜¯å¦æ­£ç¡®

## å¸¸è§é—®é¢˜é€ŸæŸ¥

### Q: æ„å»ºä¸€ç›´å¡åœ¨ "æ„å»ºä¸­..."
**A**: 
1. ä½¿ç”¨ `--debug` æŸ¥çœ‹è¯¦ç»†ä¿¡æ¯
2. æ£€æŸ¥é…ç½®æ–‡ä»¶æ˜¯å¦æ­£ç¡®
3. ç¡®è®¤å…¥å£æ–‡ä»¶å­˜åœ¨
4. è¿è¡Œ `tsc --noEmit` æ£€æŸ¥ TypeScript é”™è¯¯

### Q: æ²¡æœ‰ä»»ä½•è¾“å‡ºæ–‡ä»¶
**A**:
1. æ£€æŸ¥ `output` é…ç½®
2. ç¡®è®¤ `clean: true` æ²¡æœ‰è¯¯åˆ æ–‡ä»¶
3. æŸ¥çœ‹æ˜¯å¦æœ‰æ„å»ºé”™è¯¯

### Q: ç±»å‹å£°æ˜æ–‡ä»¶æœªç”Ÿæˆ
**A**:
1. ç¡®è®¤ `dts: true` å·²è®¾ç½®
2. æ£€æŸ¥ TypeScript é…ç½®
3. ä½¿ç”¨ `--debug` æŸ¥çœ‹ DTS ç”Ÿæˆæ—¥å¿—

### Q: æ„å»ºå¾ˆæ…¢
**A**:
1. å¯ç”¨ç¼“å­˜: `cache: { enabled: true }`
2. å‡å°‘å…¥å£æ–‡ä»¶æ•°é‡
3. ä½¿ç”¨ `bundleless: false`
4. æ£€æŸ¥æ˜¯å¦æœ‰å¤§é‡ä¾èµ–

## è·å–å¸®åŠ©

### æŸ¥çœ‹å¸®åŠ©ä¿¡æ¯
```bash
pnpm ldesign-builder --help
pnpm ldesign-builder build --help
```

### æŸ¥çœ‹ç‰ˆæœ¬
```bash
pnpm ldesign-builder --version
```

### æŠ¥å‘Šé—®é¢˜
å¦‚æœä»¥ä¸Šæ–¹æ³•éƒ½æ— æ³•è§£å†³é—®é¢˜ï¼Œè¯·æä¾›ä»¥ä¸‹ä¿¡æ¯ï¼š
1. å®Œæ•´çš„é”™è¯¯æ—¥å¿—ï¼ˆä½¿ç”¨ `--debug`ï¼‰
2. é…ç½®æ–‡ä»¶å†…å®¹
3. `package.json` ç›¸å…³éƒ¨åˆ†
4. Node.js å’Œ pnpm ç‰ˆæœ¬
5. æ“ä½œç³»ç»Ÿä¿¡æ¯
