# @ldesign/builder æ¶æ„è®¾è®¡æ–‡æ¡£

> **ç‰ˆæœ¬ï¼š** 1.0.0  
> **æœ€åæ›´æ–°ï¼š** 2024-01-01  
> **ç»´æŠ¤è€…ï¼š** LDesign Team

---

## ğŸ“ æ¶æ„æ¦‚è§ˆ

### æ€»ä½“æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     CLI å‘½ä»¤è¡Œæ¥å£                           â”‚
â”‚                   (commander + inquirer)                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   LibraryBuilder                            â”‚
â”‚                 (æ ¸å¿ƒæ§åˆ¶å™¨ - åè°ƒè€…)                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚ConfigManager â”‚  â”‚StrategyMgr  â”‚  â”‚PluginManager â”‚     â”‚
â”‚  â”‚ (é…ç½®ç®¡ç†)   â”‚  â”‚  (ç­–ç•¥é€‰æ‹©)  â”‚  â”‚  (æ’ä»¶ç³»ç»Ÿ)  â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚PerformanceMonâ”‚  â”‚LibraryDetect â”‚  â”‚PostBuildValidâ”‚     â”‚
â”‚  â”‚ (æ€§èƒ½ç›‘æ§)   â”‚  â”‚  (ç±»å‹æ£€æµ‹)  â”‚  â”‚   (éªŒè¯å™¨)   â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              UnifiedBundlerAdapter                          â”‚
â”‚              (ç»Ÿä¸€æ‰“åŒ…å™¨æ¥å£)                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Rollup    â”‚  Rolldown  â”‚   Esbuild   â”‚       SWC          â”‚
â”‚  Adapter   â”‚  Adapter   â”‚   Adapter   â”‚     Adapter        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Strategy Layer                            â”‚
â”‚              (ç­–ç•¥æ¨¡å¼ - æ¡†æ¶ç‰¹å®šé€»è¾‘)                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Vue3  â”‚  Vue2  â”‚ React  â”‚Svelte â”‚ Solid  â”‚   ...13ç§     â”‚
â”‚Strategyâ”‚Strategyâ”‚Strategyâ”‚Strategyâ”‚Strategyâ”‚   Strategies  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ—ï¸ æ ¸å¿ƒç»„ä»¶è¯¦è§£

### 1. LibraryBuilderï¼ˆæ ¸å¿ƒæ§åˆ¶å™¨ï¼‰

**èŒè´£ï¼š**
- åè°ƒæ‰€æœ‰å­ç»„ä»¶
- ç®¡ç†æ„å»ºç”Ÿå‘½å‘¨æœŸ
- å¤„ç†æ„å»ºäº‹ä»¶
- æä¾›ç»Ÿä¸€çš„æ„å»ºæ¥å£

**è®¾è®¡æ¨¡å¼ï¼š**
- å¤–è§‚æ¨¡å¼ï¼ˆFacadeï¼‰ï¼šä¸ºå¤æ‚çš„å­ç³»ç»Ÿæä¾›ç®€å•æ¥å£
- è§‚å¯Ÿè€…æ¨¡å¼ï¼ˆObserverï¼‰ï¼šé€šè¿‡äº‹ä»¶é€šçŸ¥æ„å»ºçŠ¶æ€å˜åŒ–
- ä¾èµ–æ³¨å…¥ï¼ˆDIï¼‰ï¼šæ‰€æœ‰ç»„ä»¶é€šè¿‡æ„é€ å‡½æ•°æ³¨å…¥

**æ ¸å¿ƒæµç¨‹ï¼š**
```
æ„å»ºæµç¨‹ï¼ˆbuildæ–¹æ³•ï¼‰
â”œâ”€ 1. çŠ¶æ€æ£€æŸ¥å’Œè®¾ç½®
â”œâ”€ 2. é…ç½®åˆå¹¶å’ŒéªŒè¯
â”œâ”€ 3. æ£€æŸ¥æ„å»ºç¼“å­˜
â”‚    â”œâ”€ å‘½ä¸­ â†’ è¿”å›ç¼“å­˜ç»“æœ
â”‚    â””â”€ æœªå‘½ä¸­ â†’ ç»§ç»­æ„å»º
â”œâ”€ 4. é€‰æ‹©æ„å»ºç­–ç•¥
â”œâ”€ 5. é¢„å¤„ç†æºä»£ç 
â”œâ”€ 6. æ‰§è¡Œæ‰“åŒ…
â”œâ”€ 7. åå¤„ç†äº§ç‰©
â”œâ”€ 8. ä»£ç è´¨é‡æ£€æŸ¥
â”œâ”€ 9. æ„å»ºåéªŒè¯
â”œâ”€ 10. ç”Ÿæˆæ„å»ºæŠ¥å‘Š
â”œâ”€ 11. ä¿å­˜ç¼“å­˜
â””â”€ 12. è§¦å‘å®Œæˆäº‹ä»¶
```

### 2. ConfigManagerï¼ˆé…ç½®ç®¡ç†å™¨ï¼‰

**èŒè´£ï¼š**
- åŠ è½½é…ç½®æ–‡ä»¶
- éªŒè¯é…ç½®å®Œæ•´æ€§
- æ™ºèƒ½åˆå¹¶é…ç½®
- ç›‘å¬é…ç½®å˜æ›´

**è®¾è®¡æ¨¡å¼ï¼š**
- å•ä¾‹æ¨¡å¼ï¼ˆå»ºè®®ï¼‰ï¼šå…¨å±€å…±äº«ä¸€ä¸ªå®ä¾‹
- è§‚å¯Ÿè€…æ¨¡å¼ï¼šé…ç½®å˜æ›´æ—¶é€šçŸ¥è®¢é˜…è€…
- ç­–ç•¥æ¨¡å¼ï¼šæ”¯æŒå¤šç§åˆå¹¶ç­–ç•¥

**é…ç½®å¤„ç†æµç¨‹ï¼š**
```
loadConfigæ–¹æ³•
â”œâ”€ 1. æŸ¥æ‰¾é…ç½®æ–‡ä»¶
â”œâ”€ 2. åŠ è½½é…ç½®å†…å®¹
â”œâ”€ 3. åˆå¹¶é»˜è®¤é…ç½®
â”œâ”€ 4. è§£æç¯å¢ƒå˜é‡
â”œâ”€ 5. åº”ç”¨ç¯å¢ƒé…ç½®
â”œâ”€ 6. è‡ªåŠ¨å¢å¼ºé…ç½®
â”œâ”€ 7. éªŒè¯é…ç½®
â”œâ”€ 8. å†»ç»“é…ç½®ï¼ˆå¯é€‰ï¼‰
â”œâ”€ 9. å¯åŠ¨ç›‘å¬ï¼ˆå¯é€‰ï¼‰
â””â”€ 10. è§¦å‘ loaded äº‹ä»¶
```

### 3. StrategyManagerï¼ˆç­–ç•¥ç®¡ç†å™¨ï¼‰

**èŒè´£ï¼š**
- æ³¨å†Œæ„å»ºç­–ç•¥
- æ£€æµ‹é¡¹ç›®ç±»å‹
- é€‰æ‹©æœ€ä½³ç­–ç•¥
- åº”ç”¨ç­–ç•¥é…ç½®

**è®¾è®¡æ¨¡å¼ï¼š**
- ç­–ç•¥æ¨¡å¼ï¼ˆStrategyï¼‰ï¼šä¸åŒæ¡†æ¶ä½¿ç”¨ä¸åŒç­–ç•¥
- æ³¨å†Œè¡¨æ¨¡å¼ï¼ˆRegistryï¼‰ï¼šç®¡ç†ç­–ç•¥æ³¨å†Œè¡¨
- å·¥å‚æ¨¡å¼ï¼ˆFactoryï¼‰ï¼šåˆ›å»ºç­–ç•¥å®ä¾‹

**ç­–ç•¥æ£€æµ‹æµç¨‹ï¼š**
```
detectStrategyæ–¹æ³•
â”œâ”€ 1. è¯»å– package.json
â”‚    â”œâ”€ æ£€æµ‹ Vue ä¾èµ–
â”‚    â”œâ”€ æ£€æµ‹ React ä¾èµ–
â”‚    â”œâ”€ æ£€æµ‹ Svelte ä¾èµ–
â”‚    â””â”€ æ£€æµ‹å…¶ä»–æ¡†æ¶ä¾èµ–
â”œâ”€ 2. æ‰«ææºä»£ç æ–‡ä»¶
â”‚    â”œâ”€ æ£€æµ‹ .vue æ–‡ä»¶
â”‚    â”œâ”€ æ£€æµ‹ .jsx/.tsx æ–‡ä»¶
â”‚    â””â”€ æ£€æµ‹ .svelte æ–‡ä»¶
â”œâ”€ 3. ç»¼åˆåˆ†æ
â”‚    â”œâ”€ è®¡ç®—ç½®ä¿¡åº¦
â”‚    â”œâ”€ æä¾›è¯æ®åˆ—è¡¨
â”‚    â””â”€ æ¨èå¤‡é€‰æ–¹æ¡ˆ
â””â”€ 4. è¿”å›æ£€æµ‹ç»“æœ
```

### 4. UnifiedBundlerAdapterï¼ˆç»Ÿä¸€é€‚é…å™¨ï¼‰

**èŒè´£ï¼š**
- ä¸ºä¸åŒæ‰“åŒ…å™¨æä¾›ç»Ÿä¸€æ¥å£
- ç®¡ç†æ‰“åŒ…å™¨åˆ‡æ¢
- é›†æˆæ€§èƒ½ä¼˜åŒ–
- æä¾›ç¼“å­˜æ”¯æŒ

**è®¾è®¡æ¨¡å¼ï¼š**
- é€‚é…å™¨æ¨¡å¼ï¼ˆAdapterï¼‰ï¼šç»Ÿä¸€ä¸åŒæ‰“åŒ…å™¨çš„æ¥å£
- è£…é¥°å™¨æ¨¡å¼ï¼ˆDecoratorï¼‰ï¼šåœ¨åŸæœ‰åŠŸèƒ½ä¸Šæ·»åŠ ç¼“å­˜å’Œæ€§èƒ½ç›‘æ§
- ä»£ç†æ¨¡å¼ï¼ˆProxyï¼‰ï¼šä»£ç†åº•å±‚æ‰“åŒ…å™¨çš„è°ƒç”¨

**é€‚é…å™¨å±‚æ¬¡ï¼š**
```
UnifiedBundlerAdapterï¼ˆç»Ÿä¸€å±‚ï¼‰
    â”‚
    â”œâ”€ RollupAdapterï¼ˆRollup é€‚é…å™¨ï¼‰
    â”‚    â””â”€ Rollup æ ¸å¿ƒ
    â”‚
    â”œâ”€ RolldownAdapterï¼ˆRolldown é€‚é…å™¨ï¼‰
    â”‚    â””â”€ Rolldown æ ¸å¿ƒ
    â”‚
    â”œâ”€ EsbuildAdapterï¼ˆEsbuild é€‚é…å™¨ï¼‰
    â”‚    â””â”€ Esbuild æ ¸å¿ƒ
    â”‚
    â””â”€ SwcAdapterï¼ˆSWC é€‚é…å™¨ï¼‰
         â””â”€ SWC æ ¸å¿ƒ
```

---

## ğŸ”„ æ•°æ®æµå›¾

### æ„å»ºæ•°æ®æµ

```
ç”¨æˆ·é…ç½®
    â†“
ConfigManager.loadConfig()
    â†“
é…ç½®éªŒè¯å’Œå¢å¼º
    â†“
LibraryBuilder.build()
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç­–ç•¥æ£€æµ‹å’Œåº”ç”¨          â”‚
â”‚  StrategyManager         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ‰“åŒ…å™¨é€‚é…              â”‚
â”‚  UnifiedBundlerAdapter   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
å®é™…æ‰“åŒ…ï¼ˆRollup/Rolldownç­‰ï¼‰
    â†“
æ„å»ºäº§ç‰©
    â†“
åå¤„ç†ï¼ˆå‹ç¼©ã€ä¼˜åŒ–ï¼‰
    â†“
éªŒè¯
    â†“
æœ€ç»ˆè¾“å‡º
```

### ç¼“å­˜æ•°æ®æµ

```
æ„å»ºè¯·æ±‚
    â†“
ç”Ÿæˆç¼“å­˜é”®ï¼ˆé…ç½®å“ˆå¸Œï¼‰
    â†“
æ£€æŸ¥ç¼“å­˜
    â”œâ”€ å‘½ä¸­ â†’ éªŒè¯ç¼“å­˜æœ‰æ•ˆæ€§
    â”‚         â”œâ”€ æœ‰æ•ˆ â†’ è¿”å›ç¼“å­˜ç»“æœ âœ…
    â”‚         â””â”€ æ— æ•ˆ â†’ æ‰§è¡Œæ„å»º
    â”‚
    â””â”€ æœªå‘½ä¸­ â†’ æ‰§è¡Œæ„å»º
                  â†“
              ä¿å­˜ç¼“å­˜
                  â†“
              è¿”å›ç»“æœ
```

---

## ğŸ¯ è®¾è®¡åŸåˆ™

### 1. SOLID åŸåˆ™åº”ç”¨

#### S - å•ä¸€èŒè´£åŸåˆ™ï¼ˆSingle Responsibilityï¼‰
```typescript
// âœ… æ¯ä¸ªç±»åªè´Ÿè´£ä¸€ä¸ªåŠŸèƒ½
class ConfigManager {
  // åªè´Ÿè´£é…ç½®ç®¡ç†
}

class BuildValidator {
  // åªè´Ÿè´£æ„å»ºéªŒè¯
}

class BuildCache {
  // åªè´Ÿè´£ç¼“å­˜ç®¡ç†
}
```

#### O - å¼€é—­åŸåˆ™ï¼ˆOpen/Closedï¼‰
```typescript
// âœ… å¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å…³é—­
interface ILibraryStrategy {
  applyStrategy(config: BuilderConfig): BuilderConfig
}

// æ–°å¢æ¡†æ¶æ”¯æŒæ—¶ï¼Œä¸ä¿®æ”¹ç°æœ‰ä»£ç ï¼Œåªæ·»åŠ æ–°ç­–ç•¥
class NewFrameworkStrategy implements ILibraryStrategy {
  applyStrategy(config) {
    // æ–°æ¡†æ¶çš„æ„å»ºé€»è¾‘
  }
}
```

#### L - é‡Œæ°æ›¿æ¢åŸåˆ™ï¼ˆLiskov Substitutionï¼‰
```typescript
// âœ… æ‰€æœ‰é€‚é…å™¨éƒ½å¯ä»¥äº’ç›¸æ›¿æ¢
interface IBundlerAdapter {
  build(config: UnifiedConfig): Promise<BuildResult>
}

// å¯ä»¥æ— ç¼åˆ‡æ¢
const adapter: IBundlerAdapter = new RollupAdapter()
const adapter2: IBundlerAdapter = new RolldownAdapter()
```

#### I - æ¥å£éš”ç¦»åŸåˆ™ï¼ˆInterface Segregationï¼‰
```typescript
// âœ… æ¥å£ç»†åˆ†ï¼Œä¸å¼ºåˆ¶å®ç°ä¸éœ€è¦çš„æ–¹æ³•
interface IBuilder {
  build(config: BuilderConfig): Promise<BuildResult>
}

interface IWatcher {
  watch(config: BuilderConfig): Promise<BuildWatcher>
}

// å®¢æˆ·ç«¯å¯ä»¥åªä¾èµ–éœ€è¦çš„æ¥å£
```

#### D - ä¾èµ–å€’ç½®åŸåˆ™ï¼ˆDependency Inversionï¼‰
```typescript
// âœ… ä¾èµ–æŠ½è±¡è€Œéå…·ä½“å®ç°
class LibraryBuilder {
  constructor(
    private configManager: IConfigManager,  // ä¾èµ–æ¥å£
    private strategyManager: IStrategyManager  // ä¾èµ–æ¥å£
  ) {}
}
```

### 2. è®¾è®¡æ¨¡å¼åº”ç”¨æ€»ç»“

| æ¨¡å¼ | åº”ç”¨åœºæ™¯ | å®ç°ç±» |
|------|---------|--------|
| **ç­–ç•¥æ¨¡å¼** | ä¸åŒæ¡†æ¶çš„æ„å»ºç­–ç•¥ | StrategyManager, Strategyå®ç°ç±» |
| **é€‚é…å™¨æ¨¡å¼** | ç»Ÿä¸€ä¸åŒæ‰“åŒ…å™¨æ¥å£ | UnifiedBundlerAdapter, Adapterå®ç°ç±» |
| **è§‚å¯Ÿè€…æ¨¡å¼** | æ„å»ºäº‹ä»¶é€šçŸ¥ | LibraryBuilder, ConfigManager |
| **å·¥å‚æ¨¡å¼** | åˆ›å»ºé€‚é…å™¨å’Œç­–ç•¥ | BundlerAdapterFactory |
| **å•ä¾‹æ¨¡å¼** | å…¨å±€å…±äº«å®ä¾‹ | Logger, ErrorHandler |
| **è£…é¥°å™¨æ¨¡å¼** | å¢å¼ºæ‰“åŒ…å™¨åŠŸèƒ½ | UnifiedBundlerAdapter |
| **è´£ä»»é“¾æ¨¡å¼** | æ’ä»¶å¤„ç†é“¾ | PluginManager |
| **å¤–è§‚æ¨¡å¼** | ç®€åŒ–å¤æ‚å­ç³»ç»Ÿ | LibraryBuilder |

---

## ğŸ”§ å…³é”®æŠ€æœ¯å†³ç­–

### å†³ç­–1ï¼šä¸ºä»€ä¹ˆé€‰æ‹©é€‚é…å™¨æ¨¡å¼ï¼Ÿ

**é—®é¢˜ï¼š**
éœ€è¦æ”¯æŒå¤šä¸ªæ‰“åŒ…å™¨ï¼ˆRollupã€Rolldownã€Esbuildã€SWCï¼‰ï¼Œä½†å®ƒä»¬çš„ API å„ä¸ç›¸åŒ

**æ–¹æ¡ˆå¯¹æ¯”ï¼š**

| æ–¹æ¡ˆ | ä¼˜ç‚¹ | ç¼ºç‚¹ | é€‰æ‹© |
|------|------|------|------|
| ç›´æ¥ä½¿ç”¨ | ç®€å•ç›´æ¥ | ä»£ç é‡å¤ï¼Œéš¾ä»¥åˆ‡æ¢ | âŒ |
| é€‚é…å™¨æ¨¡å¼ | ç»Ÿä¸€æ¥å£ï¼Œæ˜“æ‰©å±• | å¢åŠ ä¸€å±‚æŠ½è±¡ | âœ… |
| ç­–ç•¥æ¨¡å¼ | çµæ´» | æ¯ä¸ªç­–ç•¥éœ€è¦å®Œæ•´å®ç° | âŒ |

**æœ€ç»ˆå†³ç­–ï¼š** ä½¿ç”¨é€‚é…å™¨æ¨¡å¼

**ç†ç”±ï¼š**
1. æä¾›ç»Ÿä¸€çš„ `build()` å’Œ `watch()` æ¥å£
2. æ”¯æŒè¿è¡Œæ—¶åˆ‡æ¢æ‰“åŒ…å™¨
3. ä¾¿äºæ·»åŠ æ–°çš„æ‰“åŒ…å™¨æ”¯æŒ
4. å¯ä»¥åœ¨é€‚é…å™¨å±‚ç»Ÿä¸€æ·»åŠ ç¼“å­˜ã€æ€§èƒ½ç›‘æ§ç­‰åŠŸèƒ½

### å†³ç­–2ï¼šä¸ºä»€ä¹ˆä½¿ç”¨ç­–ç•¥æ¨¡å¼å¤„ç†æ¡†æ¶å·®å¼‚ï¼Ÿ

**é—®é¢˜ï¼š**
ä¸åŒæ¡†æ¶ï¼ˆVueã€Reactã€Svelteç­‰ï¼‰çš„æ„å»ºé…ç½®å·®å¼‚å¾ˆå¤§

**æ–¹æ¡ˆå¯¹æ¯”ï¼š**

| æ–¹æ¡ˆ | ä¼˜ç‚¹ | ç¼ºç‚¹ | é€‰æ‹© |
|------|------|------|------|
| if-else åˆ¤æ–­ | ç®€å• | éš¾ä»¥ç»´æŠ¤ï¼Œè€¦åˆåº¦é«˜ | âŒ |
| ç­–ç•¥æ¨¡å¼ | è§£è€¦ï¼Œæ˜“æ‰©å±• | éœ€è¦æ›´å¤šç±» | âœ… |
| é…ç½®æ˜ å°„è¡¨ | ç®€å• | ç¼ºä¹çµæ´»æ€§ | âŒ |

**æœ€ç»ˆå†³ç­–ï¼š** ä½¿ç”¨ç­–ç•¥æ¨¡å¼

**ç†ç”±ï¼š**
1. æ¯ä¸ªæ¡†æ¶çš„é€»è¾‘ç‹¬ç«‹ï¼Œäº’ä¸å½±å“
2. æ–°å¢æ¡†æ¶æ”¯æŒæ—¶ï¼Œåªéœ€æ·»åŠ æ–°ç­–ç•¥
3. æ”¯æŒæ··åˆæ¡†æ¶é¡¹ç›®
4. ä¾¿äºæµ‹è¯•å’Œç»´æŠ¤

### å†³ç­–3ï¼šä¸ºä»€ä¹ˆé€‰æ‹© EventEmitterï¼Ÿ

**é—®é¢˜ï¼š**
éœ€è¦åœ¨æ„å»ºè¿‡ç¨‹ä¸­é€šçŸ¥å¤–éƒ¨ç³»ç»Ÿï¼ˆè¿›åº¦ã€çŠ¶æ€å˜åŒ–ç­‰ï¼‰

**æ–¹æ¡ˆå¯¹æ¯”ï¼š**

| æ–¹æ¡ˆ | ä¼˜ç‚¹ | ç¼ºç‚¹ | é€‰æ‹© |
|------|------|------|------|
| å›è°ƒå‡½æ•° | ç®€å• | éš¾ä»¥ç®¡ç†å¤šä¸ªå›è°ƒ | âŒ |
| EventEmitter | Node.js æ ‡å‡†ï¼Œçµæ´» | éœ€è¦äº†è§£äº‹ä»¶æœºåˆ¶ | âœ… |
| RxJS | åŠŸèƒ½å¼ºå¤§ | å¢åŠ ä¾èµ–ï¼Œå­¦ä¹ æˆæœ¬é«˜ | âŒ |

**æœ€ç»ˆå†³ç­–ï¼š** ä½¿ç”¨ EventEmitter

**ç†ç”±ï¼š**
1. Node.js å†…ç½®ï¼Œæ— éœ€é¢å¤–ä¾èµ–
2. æ”¯æŒå¤šä¸ªç›‘å¬å™¨
3. æ˜“äºç†è§£å’Œä½¿ç”¨
4. æ€§èƒ½ä¼˜ç§€

---

## ğŸ“Š æ¨¡å—ä¾èµ–å…³ç³»

### æ ¸å¿ƒæ¨¡å—ä¾èµ–å›¾

```
LibraryBuilder
    â”œâ”€â†’ ConfigManager
    â”‚       â””â”€â†’ ConfigLoader
    â”‚
    â”œâ”€â†’ StrategyManager
    â”‚       â”œâ”€â†’ TypeScriptStrategy
    â”‚       â”œâ”€â†’ Vue3Strategy
    â”‚       â”œâ”€â†’ ReactStrategy
    â”‚       â””â”€â†’ ... (å…¶ä»–ç­–ç•¥)
    â”‚
    â”œâ”€â†’ PluginManager
    â”‚       â””â”€â†’ Plugin å®ä¾‹
    â”‚
    â”œâ”€â†’ UnifiedBundlerAdapter
    â”‚       â”œâ”€â†’ RollupAdapter
    â”‚       â”œâ”€â†’ RolldownAdapter
    â”‚       â”œâ”€â†’ EsbuildAdapter
    â”‚       â””â”€â†’ SwcAdapter
    â”‚
    â”œâ”€â†’ PerformanceMonitor
    â”œâ”€â†’ LibraryDetector
    â””â”€â†’ PostBuildValidator
```

### ä¾èµ–å±‚æ¬¡

```
Level 0ï¼ˆæ— ä¾èµ–ï¼‰:
  - Logger
  - ErrorHandler
  - å¸¸é‡å’Œç±»å‹å®šä¹‰

Level 1ï¼ˆåŸºç¡€å·¥å…·ï¼‰:
  - FileSystem
  - PathUtils
  - FormatUtils

Level 2ï¼ˆæ ¸å¿ƒç»„ä»¶ï¼‰:
  - ConfigManager
  - BuildCache
  - DependencyAnalyzer

Level 3ï¼ˆé«˜çº§ç»„ä»¶ï¼‰:
  - StrategyManager
  - PluginManager
  - UnifiedBundlerAdapter

Level 4ï¼ˆé¡¶å±‚ï¼‰:
  - LibraryBuilder
  - MonorepoBuilder
```

---

## ğŸ” å…³é”®æŠ½è±¡å’Œæ¥å£

### 1. IBundlerAdapterï¼ˆæ‰“åŒ…å™¨é€‚é…å™¨æ¥å£ï¼‰

```typescript
/**
 * æ‰€æœ‰æ‰“åŒ…å™¨é€‚é…å™¨å¿…é¡»å®ç°çš„æ¥å£
 */
interface IBundlerAdapter {
  // åŸºç¡€å±æ€§
  name: string
  version: string
  available: boolean
  
  // æ ¸å¿ƒæ–¹æ³•
  build(config: UnifiedConfig): Promise<BuildResult>
  watch(config: UnifiedConfig): Promise<BuildWatcher>
  
  // è½¬æ¢æ–¹æ³•
  transformConfig(config: UnifiedConfig): Promise<BundlerSpecificConfig>
  transformPlugins(plugins: UnifiedPlugin[]): Promise<BundlerSpecificPlugin[]>
  
  // æ€§èƒ½æ–¹æ³•
  getPerformanceMetrics(): PerformanceMetrics
  
  // èµ„æºç®¡ç†
  dispose(): Promise<void>
}
```

### 2. ILibraryStrategyï¼ˆåº“ç­–ç•¥æ¥å£ï¼‰

```typescript
/**
 * æ‰€æœ‰æ„å»ºç­–ç•¥å¿…é¡»å®ç°çš„æ¥å£
 */
interface ILibraryStrategy {
  // åŸºç¡€å±æ€§
  name: string
  supportedTypes: LibraryType[]
  
  // æ ¸å¿ƒæ–¹æ³•
  isApplicable(config: BuilderConfig): boolean
  applyStrategy(config: BuilderConfig): Promise<BuilderConfig>
  
  // æ¨èæ–¹æ³•
  getRecommendedPlugins(config: BuilderConfig): UnifiedPlugin[]
  getRecommendedOptions(config: BuilderConfig): Partial<BuilderConfig>
}
```

### 3. UnifiedPluginï¼ˆç»Ÿä¸€æ’ä»¶æ¥å£ï¼‰

```typescript
/**
 * æ’ä»¶æ ‡å‡†æ¥å£
 */
interface UnifiedPlugin {
  // åŸºç¡€ä¿¡æ¯
  name: string
  version?: string
  
  // ç”Ÿå‘½å‘¨æœŸé’©å­
  onInit?(context: PluginContext): void | Promise<void>
  onBuildStart?(context: PluginContext): void | Promise<void>
  onBuildEnd?(context: PluginContext, result: BuildResult): void | Promise<void>
  onDispose?(): void | Promise<void>
  
  // åº”ç”¨æ’ä»¶
  apply(config: BuilderConfig): BuilderConfig
}
```

---

## ğŸ¨ ä»£ç ç»„ç»‡åŸåˆ™

### 1. æ–‡ä»¶ç»„ç»‡åŸåˆ™

**æŒ‰åŠŸèƒ½åˆ†å±‚ï¼š**
```
src/
â”œâ”€â”€ core/           # æ ¸å¿ƒä¸šåŠ¡é€»è¾‘ï¼ˆé«˜å±‚ï¼‰
â”œâ”€â”€ adapters/       # é€‚é…å™¨å±‚ï¼ˆä¸­å±‚ï¼‰
â”œâ”€â”€ strategies/     # ç­–ç•¥å±‚ï¼ˆä¸­å±‚ï¼‰
â”œâ”€â”€ plugins/        # æ’ä»¶å±‚ï¼ˆä¸­å±‚ï¼‰
â”œâ”€â”€ utils/          # å·¥å…·å±‚ï¼ˆåº•å±‚ï¼‰
â”œâ”€â”€ types/          # ç±»å‹å®šä¹‰ï¼ˆåº•å±‚ï¼‰
â””â”€â”€ constants/      # å¸¸é‡å®šä¹‰ï¼ˆåº•å±‚ï¼‰
```

**ä¾èµ–è§„åˆ™ï¼š**
- âœ… é«˜å±‚å¯ä»¥ä¾èµ–ä½å±‚
- âŒ ä½å±‚ä¸èƒ½ä¾èµ–é«˜å±‚
- âŒ åŒå±‚ä¹‹é—´æœ€å°åŒ–ä¾èµ–

### 2. æ¨¡å—å¤§å°æ§åˆ¶

**æ ‡å‡†ï¼š**
- å•ä¸ªæ–‡ä»¶ï¼š<500 è¡Œ
- å¹³å‡æ–‡ä»¶ï¼š<300 è¡Œ
- å•ä¸ªå‡½æ•°ï¼š<50 è¡Œ
- å•ä¸ªç±»ï¼š<400 è¡Œ

**è¶…è¿‡é™åˆ¶æ—¶çš„å¤„ç†ï¼š**
1. æ‹†åˆ†ä¸ºå¤šä¸ªæ–‡ä»¶
2. æå–å­æ¨¡å—
3. ä½¿ç”¨ç»„åˆæ›¿ä»£ç»§æ‰¿

### 3. å‘½åè§„èŒƒ

**æ–‡ä»¶å‘½åï¼š**
- ç±»æ–‡ä»¶ï¼š`PascalCase.ts`ï¼ˆå¦‚ `LibraryBuilder.ts`ï¼‰
- å·¥å…·æ–‡ä»¶ï¼š`camelCase.ts`ï¼ˆå¦‚ `formatUtils.ts`ï¼‰
- å¸¸é‡æ–‡ä»¶ï¼š`camelCase.ts`ï¼ˆå¦‚ `defaults.ts`ï¼‰
- ç±»å‹æ–‡ä»¶ï¼š`camelCase.ts`ï¼ˆå¦‚ `builder.ts`ï¼‰

**å˜é‡å‘½åï¼š**
- ç±»åï¼š`PascalCase`
- å‡½æ•°åï¼š`camelCase`
- å¸¸é‡ï¼š`UPPER_SNAKE_CASE`
- ç§æœ‰å±æ€§ï¼š`camelCase`ï¼ˆä¸ä½¿ç”¨ä¸‹åˆ’çº¿å‰ç¼€ï¼‰

---

## ğŸš€ æ€§èƒ½ä¼˜åŒ–æ¶æ„

### 1. ç¼“å­˜æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         ç¼“å­˜å±‚æ¬¡æ¶æ„                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  L1: å†…å­˜ç¼“å­˜ (MemoryCache)        â”‚
â”‚      - å®¹é‡ï¼š100MB                  â”‚
â”‚      - é€Ÿåº¦ï¼šæœ€å¿« (<1ms)            â”‚
â”‚      - ä½œç”¨åŸŸï¼šå•æ¬¡è¿è¡Œ              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  L2: ç£ç›˜ç¼“å­˜ (DiskCache)          â”‚
â”‚      - å®¹é‡ï¼š1GB                    â”‚
â”‚      - é€Ÿåº¦ï¼šå¿« (10-50ms)          â”‚
â”‚      - ä½œç”¨åŸŸï¼šæœ¬åœ°æœºå™¨              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  L3: åˆ†å¸ƒå¼ç¼“å­˜ (DistributedCache) â”‚
â”‚      - å®¹é‡ï¼šæ— é™                   â”‚
â”‚      - é€Ÿåº¦ï¼šè¾ƒæ…¢ (100-500ms)      â”‚
â”‚      - ä½œç”¨åŸŸï¼šå›¢é˜Ÿå…±äº«              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2. å¹¶è¡Œå¤„ç†æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      ParallelExecutor               â”‚
â”‚      (å¹¶è¡Œä»»åŠ¡è°ƒåº¦å™¨)                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ä»»åŠ¡é˜Ÿåˆ—                            â”‚
â”‚  â”œâ”€ é«˜ä¼˜å…ˆçº§é˜Ÿåˆ—                     â”‚
â”‚  â”œâ”€ æ™®é€šä¼˜å…ˆçº§é˜Ÿåˆ—                   â”‚
â”‚  â””â”€ ä½ä¼˜å…ˆçº§é˜Ÿåˆ—                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  å·¥ä½œçº¿ç¨‹æ±                           â”‚
â”‚  â”œâ”€ Worker 1                        â”‚
â”‚  â”œâ”€ Worker 2                        â”‚
â”‚  â”œâ”€ Worker 3                        â”‚
â”‚  â””â”€ ... (æ ¹æ® CPU æ ¸å¿ƒæ•°åŠ¨æ€è°ƒæ•´)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3. å†…å­˜ç®¡ç†æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      MemoryManager                  â”‚
â”‚      (å†…å­˜ç®¡ç†å™¨)                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  å†…å­˜ç›‘æ§                            â”‚
â”‚  â”œâ”€ å®æ—¶ç›‘æ§å †ä½¿ç”¨                   â”‚
â”‚  â”œâ”€ æ£€æµ‹å†…å­˜æ³„æ¼                     â”‚
â”‚  â””â”€ è§¦å‘ GC                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  å¯¹è±¡æ±                               â”‚
â”‚  â”œâ”€ Buffer æ±                        â”‚
â”‚  â”œâ”€ Object æ±                        â”‚
â”‚  â””â”€ Array æ±                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  æµå¼å¤„ç†                            â”‚
â”‚  â”œâ”€ å¤§æ–‡ä»¶æµå¼è¯»å–                   â”‚
â”‚  â”œâ”€ æµå¼è½¬æ¢                         â”‚
â”‚  â””â”€ æµå¼è¾“å‡º                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ§ª æµ‹è¯•æ¶æ„

### 1. æµ‹è¯•é‡‘å­—å¡”

```
         /\
        /  \  E2E æµ‹è¯•ï¼ˆ10%ï¼‰
       /â”€â”€â”€â”€\  - å®Œæ•´æ„å»ºæµç¨‹æµ‹è¯•
      /      \  - è·¨å¹³å°å…¼å®¹æ€§æµ‹è¯•
     /â”€â”€â”€â”€â”€â”€â”€â”€\
    /          \ é›†æˆæµ‹è¯•ï¼ˆ30%ï¼‰
   /â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\  - ç»„ä»¶é›†æˆæµ‹è¯•
  /              \  - API é›†æˆæµ‹è¯•
 /â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\
/                  \ å•å…ƒæµ‹è¯•ï¼ˆ60%ï¼‰
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  - çº¯å‡½æ•°æµ‹è¯•
                      - ç±»æ–¹æ³•æµ‹è¯•
                      - å·¥å…·å‡½æ•°æµ‹è¯•
```

### 2. æµ‹è¯•ç­–ç•¥

**å•å…ƒæµ‹è¯•ï¼š**
- è¦†ç›–æ‰€æœ‰å…¬å…±æ–¹æ³•
- è¦†ç›–ä¸»è¦çš„åˆ†æ”¯é€»è¾‘
- ä½¿ç”¨ Mock éš”ç¦»ä¾èµ–

**é›†æˆæµ‹è¯•ï¼š**
- æµ‹è¯•ç»„ä»¶é—´åä½œ
- æµ‹è¯•å®Œæ•´çš„å·¥ä½œæµ
- ä½¿ç”¨çœŸå®ä¾èµ–

**E2E æµ‹è¯•ï¼š**
- æµ‹è¯• CLI å‘½ä»¤
- æµ‹è¯•çœŸå®é¡¹ç›®æ„å»º
- æµ‹è¯•å„ç§é…ç½®ç»„åˆ

---

## ğŸ“ˆ æ‰©å±•æ€§è®¾è®¡

### 1. å¦‚ä½•æ·»åŠ æ–°çš„æ‰“åŒ…å™¨æ”¯æŒï¼Ÿ

```typescript
// æ­¥éª¤1ï¼šåˆ›å»ºé€‚é…å™¨
// src/adapters/webpack/WebpackAdapter.ts
import type { IBundlerAdapter } from '../../types/adapter'

export class WebpackAdapter implements IBundlerAdapter {
  name = 'webpack'
  version = '1.0.0'
  available = true
  
  async build(config) {
    // ä½¿ç”¨ Webpack æ„å»º
  }
  
  async watch(config) {
    // ä½¿ç”¨ Webpack ç›‘å¬
  }
  
  // ... å®ç°å…¶ä»–æ–¹æ³•
}

// æ­¥éª¤2ï¼šæ³¨å†Œåˆ°å·¥å‚
// src/adapters/base/AdapterFactory.ts
export class BundlerAdapterFactory {
  static create(bundler: BundlerType): IBundlerAdapter {
    switch (bundler) {
      case 'rollup': return new RollupAdapter()
      case 'rolldown': return new RolldownAdapter()
      case 'webpack': return new WebpackAdapter()  // â† æ–°å¢
      default: throw new Error(`Unknown bundler: ${bundler}`)
    }
  }
}
```

### 2. å¦‚ä½•æ·»åŠ æ–°çš„æ¡†æ¶æ”¯æŒï¼Ÿ

```typescript
// æ­¥éª¤1ï¼šåˆ›å»ºç­–ç•¥
// src/strategies/nuxt3/Nuxt3Strategy.ts
import type { ILibraryStrategy } from '../../types/strategy'

export class Nuxt3Strategy implements ILibraryStrategy {
  name = 'Nuxt3Strategy'
  supportedTypes = [LibraryType.NUXT3]
  
  isApplicable(config) {
    // æ£€æŸ¥æ˜¯å¦é€‚ç”¨äº Nuxt 3
  }
  
  async applyStrategy(config) {
    // åº”ç”¨ Nuxt 3 ç‰¹å®šé…ç½®
    return {
      ...config,
      external: ['vue', 'nuxt', '@nuxt/kit'],
      // Nuxt 3 ç‰¹å®šçš„é…ç½®
    }
  }
  
  getRecommendedPlugins(config) {
    // æ¨è Nuxt 3 ç›¸å…³æ’ä»¶
  }
}

// æ­¥éª¤2ï¼šæ³¨å†Œåˆ°ç®¡ç†å™¨
// src/core/StrategyManager.ts
private registerDefaultStrategies() {
  this.registerStrategy(new Nuxt3Strategy())  // â† æ–°å¢
  // ... å…¶ä»–ç­–ç•¥
}
```

### 3. å¦‚ä½•æ·»åŠ æ–°çš„æ’ä»¶ï¼Ÿ

```typescript
// åˆ›å»ºæ’ä»¶
// src/plugins/my-custom-plugin.ts
import type { UnifiedPlugin } from '../types/plugin'

export interface MyPluginOptions {
  feature: boolean
}

export function myCustomPlugin(options: MyPluginOptions = {}): UnifiedPlugin {
  return {
    name: 'my-custom-plugin',
    version: '1.0.0',
    
    apply(config) {
      // ä¿®æ”¹é…ç½®æˆ–æ·»åŠ  Rollup æ’ä»¶
      return {
        ...config,
        plugins: [
          ...config.plugins,
          // ä½ çš„ Rollup æ’ä»¶
        ]
      }
    }
  }
}

// ä½¿ç”¨æ’ä»¶
import { myCustomPlugin } from './plugins/my-custom-plugin'

export default defineConfig({
  plugins: [
    myCustomPlugin({ feature: true })
  ]
})
```

---

## ğŸ¯ æœªæ¥æ¶æ„æ¼”è¿›

### çŸ­æœŸï¼ˆ3-6ä¸ªæœˆï¼‰

1. **æ’ä»¶ç”Ÿæ€å»ºè®¾**
   - å®˜æ–¹æ’ä»¶åº“æ‰©å±•
   - æ’ä»¶å¸‚åœºä¸Šçº¿
   - æ’ä»¶å¼€å‘ SDK

2. **æ€§èƒ½ä¼˜åŒ–**
   - å®ç°åˆ†å±‚ç¼“å­˜
   - ä¼˜åŒ–å¹¶è¡Œè°ƒåº¦ç®—æ³•
   - å†…å­˜æ± ç®¡ç†

3. **å¼€å‘ä½“éªŒ**
   - äº¤äº’å¼é…ç½®ç”Ÿæˆ
   - å®æ—¶æ„å»ºåé¦ˆ
   - å¯è§†åŒ–è°ƒè¯•å·¥å…·

### ä¸­æœŸï¼ˆ6-12ä¸ªæœˆï¼‰

1. **äº‘åŸç”Ÿæ”¯æŒ**
   - åˆ†å¸ƒå¼æ„å»º
   - äº‘ç¼“å­˜æœåŠ¡
   - è¾¹ç¼˜æ„å»º

2. **AI è¾…åŠ©**
   - æ™ºèƒ½é…ç½®æ¨è
   - æ€§èƒ½ç“¶é¢ˆè¯†åˆ«
   - ä»£ç è´¨é‡åˆ†æ

3. **å¤šç«¯æ”¯æŒ**
   - å°ç¨‹åºæ„å»º
   - ç§»åŠ¨ç«¯ä¼˜åŒ–
   - SSR/SSG æ”¯æŒ

### é•¿æœŸï¼ˆ1-2å¹´ï¼‰

1. **ç”Ÿæ€æ•´åˆ**
   - ä¸ä¸»æµæ¡†æ¶æ·±åº¦é›†æˆ
   - ä¸ CI/CD å¹³å°é›†æˆ
   - ä¸ç›‘æ§å¹³å°é›†æˆ

2. **æ ‡å‡†åŒ–**
   - æ¨åŠ¨è¡Œä¸šæ ‡å‡†åˆ¶å®š
   - å¼€æ”¾æ’ä»¶åè®®
   - ç¤¾åŒºé©±åŠ¨å‘å±•

---

## ğŸ“š å‚è€ƒèµ„æ–™

- [Rollup æ¶æ„](https://rollupjs.org/guide/en/)
- [Webpack æ¶æ„](https://webpack.js.org/concepts/)
- [Vite æ¶æ„](https://vitejs.dev/guide/api-plugin.html)
- [è®¾è®¡æ¨¡å¼](https://refactoring.guru/design-patterns)
- [SOLID åŸåˆ™](https://en.wikipedia.org/wiki/SOLID)

---

**æ–‡æ¡£ç»´æŠ¤è€…ï¼š** LDesign Team  
**è´¡çŒ®æŒ‡å—ï¼š** æ¬¢è¿æäº¤ PR æ”¹è¿›æœ¬æ–‡æ¡£

