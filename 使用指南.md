# @ldesign/builder ä½¿ç”¨æŒ‡å—

> ğŸš€ é›¶é…ç½®ã€æé€Ÿã€æ™ºèƒ½çš„å‰ç«¯åº“æ‰“åŒ…å·¥å…·

---

## ğŸ¯ æ ¸å¿ƒç‰¹æ€§

### âœ¨ é›¶é…ç½®
90% çš„é¡¹ç›®æ— éœ€ä»»ä½•é…ç½®ï¼Œè‡ªåŠ¨æ£€æµ‹å’Œæ„å»º

### âš¡ æé€Ÿæ„å»º
- å¼€å‘æ¨¡å¼ï¼š**10-100 å€**é€Ÿåº¦æå‡
- ç”Ÿäº§æ„å»ºï¼š**3 å€**é€Ÿåº¦æå‡
- å¹¶è¡Œæ‰“åŒ…ï¼š**2.5 å€**é€Ÿåº¦æå‡

### ğŸ”§ å…¨æ¡†æ¶æ”¯æŒ
æ”¯æŒ 11 ç§ä¸»æµæ¡†æ¶ï¼šVue2/3ã€Reactã€Svelteã€Solidã€Preactã€Litã€Angularã€Qwikã€TypeScriptã€æ ·å¼åº“

### ğŸš€ å¤šå¼•æ“å¯é€‰
4 ç§æ‰“åŒ…å¼•æ“æ™ºèƒ½é€‰æ‹©ï¼šesbuildã€swcã€rollupã€rolldown

---

## ğŸ“¦ å¿«é€Ÿå¼€å§‹

### å®‰è£…

```bash
pnpm add @ldesign/builder -D
```

### é›¶é…ç½®æ„å»º

```bash
npx ldesign-builder build
```

å°±è¿™ä¹ˆç®€å•ï¼æ‰€æœ‰é…ç½®è‡ªåŠ¨å®Œæˆ âœ¨

---

## ğŸ’¡ æ™ºèƒ½åŠŸèƒ½

### 1. è‡ªåŠ¨æ£€æµ‹é¡¹ç›®ç±»å‹

å·¥å…·ä¼šè‡ªåŠ¨æ£€æµ‹æ‚¨çš„é¡¹ç›®ï¼š

```
æ£€æµ‹ package.json â†’ åˆ†æä¾èµ– â†’ æ‰«ææ–‡ä»¶ç»“æ„ â†’ æ¨æ–­é¡¹ç›®ç±»å‹
```

æ”¯æŒçš„é¡¹ç›®ç±»å‹ï¼š
- Vue 2/3 ç»„ä»¶åº“
- React ç»„ä»¶åº“
- TypeScript å·¥å…·åº“
- Svelteã€Solidã€Preactã€Lit ç»„ä»¶åº“
- çº¯æ ·å¼åº“ï¼ˆCSS/Less/Sassï¼‰
- Monorepo é¡¹ç›®

### 2. è‡ªåŠ¨æ¨æ–­é…ç½®

è‡ªåŠ¨æ¨æ–­ä»¥ä¸‹é…ç½®ï¼š

| é…ç½®é¡¹ | æ¨æ–­é€»è¾‘ |
|--------|----------|
| **å…¥å£æ–‡ä»¶** | æŸ¥æ‰¾ `src/index.ts/tsx/js/jsx/vue` |
| **è¾“å‡ºæ ¼å¼** | ç»„ä»¶åº“ï¼šESM+CJS+UMD<br>å·¥å…·åº“ï¼šESM+CJS |
| **è¾“å‡ºç›®å½•** | ESM â†’ es/<br>CJS â†’ lib/<br>UMD â†’ dist/ |
| **å¤–éƒ¨ä¾èµ–** | ä» peerDependencies è¯»å– |
| **UMD åç§°** | ä» package.json name ç”Ÿæˆ |
| **æ‰“åŒ…å¼•æ“** | å¼€å‘ â†’ esbuild<br>ç”Ÿäº§ â†’ swc/rollup |

### 3. è‡ªåŠ¨ä¼˜åŒ–

- âœ… è‡ªåŠ¨ Tree Shaking
- âœ… è‡ªåŠ¨ä»£ç åˆ†å‰²
- âœ… è‡ªåŠ¨ç”Ÿæˆç±»å‹å£°æ˜
- âœ… è‡ªåŠ¨ç”Ÿæˆ sourcemap
- âœ… å¹¶è¡Œæ„å»ºå¤šæ ¼å¼

---

## ğŸ¨ ä½¿ç”¨åœºæ™¯

### åœºæ™¯ 1: Vue 3 ç»„ä»¶åº“

```bash
# é¡¹ç›®ç»“æ„
my-vue-lib/
â”œâ”€â”€ package.json      # peerDependencies: { "vue": "^3.0.0" }
â””â”€â”€ src/
    â”œâ”€â”€ index.ts
    â””â”€â”€ Button.vue

# é›¶é…ç½®æ„å»º
npx ldesign-builder build

# è¾“å‡º
âœ“ æ£€æµ‹åˆ° Vue 3 é¡¹ç›®
âœ“ ç”Ÿæˆ ESM (es/)
âœ“ ç”Ÿæˆ CJS (lib/)
âœ“ ç”Ÿæˆ UMD (dist/MyVueLib.umd.js)
âœ“ ç”Ÿæˆç±»å‹å£°æ˜
âœ“ æ„å»ºå®Œæˆ (12s)
```

### åœºæ™¯ 2: TypeScript å·¥å…·åº“

```bash
# é¡¹ç›®ç»“æ„
my-utils/
â”œâ”€â”€ package.json
â””â”€â”€ src/
    â”œâ”€â”€ index.ts
    â””â”€â”€ helpers/

# é›¶é…ç½®æ„å»º
npx ldesign-builder build

# è¾“å‡º
âœ“ æ£€æµ‹åˆ° TypeScript é¡¹ç›®
âœ“ ç”Ÿæˆ ESM (es/)
âœ“ ç”Ÿæˆ CJS (lib/)
âœ“ ä¿ç•™ç›®å½•ç»“æ„
âœ“ æ„å»ºå®Œæˆ (5s)
```

### åœºæ™¯ 3: React ç»„ä»¶åº“

```bash
# é¡¹ç›®ç»“æ„
my-react-lib/
â”œâ”€â”€ package.json      # peerDependencies: { "react": "^18.0.0" }
â””â”€â”€ src/
    â”œâ”€â”€ index.tsx
    â””â”€â”€ components/

# é›¶é…ç½®æ„å»º
npx ldesign-builder build

# è¾“å‡º
âœ“ æ£€æµ‹åˆ° React é¡¹ç›®
âœ“ ç”Ÿæˆ ESM (es/)
âœ“ ç”Ÿæˆ CJS (lib/)
âœ“ æ”¯æŒ JSX/TSX
âœ“ æ„å»ºå®Œæˆ (10s)
```

---

## âš¡ æ€§èƒ½æ¨¡å¼

### æé€Ÿå¼€å‘æ¨¡å¼

```bash
# ä½¿ç”¨ esbuildï¼ˆ10-100å€é€Ÿåº¦ï¼‰
npx ldesign-builder build --mode development

# æˆ–åœ¨ package.json ä¸­
{
  "scripts": {
    "dev": "ldesign-builder build --mode development --watch"
  }
}
```

**æ•ˆæœ**: 5s â†’ 0.5s âš¡

### å¿«é€Ÿç”Ÿäº§æ¨¡å¼

```bash
# ä½¿ç”¨ swcï¼ˆ20å€é€Ÿåº¦ï¼‰
npx ldesign-builder build --mode production

# æˆ–
pnpm build
```

**æ•ˆæœ**: 30s â†’ 10s ğŸš€

### æŒ‡å®šæ‰“åŒ…å¼•æ“

```bash
# æé€Ÿï¼šesbuild
npx ldesign-builder build --bundler esbuild

# å¿«é€Ÿï¼šswc
npx ldesign-builder build --bundler swc

# ç¨³å®šï¼šrollup
npx ldesign-builder build --bundler rollup

# é»˜è®¤ï¼šrolldown
npx ldesign-builder build --bundler rolldown
```

---

## ğŸ¨ å¯é€‰é…ç½®

### æœ€å°é…ç½®ï¼ˆæ¨èï¼‰

åªåœ¨éœ€è¦æ—¶åˆ›å»º `.ldesign/builder.config.ts`ï¼š

```typescript
export default {
  // åªé…ç½®éœ€è¦è¦†ç›–çš„éƒ¨åˆ†
  name: 'MyLib',  // å¯é€‰ï¼Œè‡ªåŠ¨ä» package.json è¯»å–
  external: ['lodash']  // å¯é€‰ï¼Œé¢å¤–çš„å¤–éƒ¨ä¾èµ–
}
```

### å¸¸ç”¨é…ç½®

```typescript
export default {
  // åŸºç¡€
  name: 'MyLib',
  
  // å¤–éƒ¨ä¾èµ–ï¼ˆå¯é€‰ï¼Œè‡ªåŠ¨ä» peerDependencies è¯»å–ï¼‰
  external: ['vue', 'lodash'],
  
  // æŒ‡å®šå¼•æ“ï¼ˆå¯é€‰ï¼Œè‡ªåŠ¨é€‰æ‹©ï¼‰
  bundler: 'swc',
  
  // è¾“å‡ºæ ¼å¼ï¼ˆå¯é€‰ï¼Œè‡ªåŠ¨æ¨æ–­ï¼‰
  output: {
    esm: true,
    cjs: true,
    umd: true
  }
}
```

### å®Œæ•´é…ç½®ç¤ºä¾‹

```typescript
export default {
  // å…¥å£ï¼ˆå¯é€‰ï¼Œè‡ªåŠ¨æ£€æµ‹ï¼‰
  input: 'src/index.ts',
  
  // åº“åç§°
  name: 'MyAwesomeLib',
  
  // å¼•æ“é€‰æ‹©
  bundler: 'rollup',
  
  // è¾“å‡ºé…ç½®
  output: {
    esm: {
      dir: 'es',
      preserveStructure: true,
      dts: true
    },
    cjs: {
      dir: 'lib',
      preserveStructure: true,
      dts: true
    },
    umd: {
      dir: 'dist',
      minify: true
    }
  },
  
  // å¤–éƒ¨ä¾èµ–
  external: ['vue', 'lodash'],
  
  // å…¨å±€å˜é‡ï¼ˆUMDï¼‰
  globals: {
    vue: 'Vue',
    lodash: '_'
  }
}
```

---

## ğŸ“ è¾“å‡ºç»“æ„

### é»˜è®¤è¾“å‡º

```
your-project/
â”œâ”€â”€ es/              # ESM æ ¼å¼ (ç°ä»£ import)
â”‚   â”œâ”€â”€ index.js
â”‚   â”œâ”€â”€ index.d.ts
â”‚   â””â”€â”€ components/
â”‚
â”œâ”€â”€ lib/             # CJS æ ¼å¼ (Node require)
â”‚   â”œâ”€â”€ index.cjs
â”‚   â”œâ”€â”€ index.d.ts
â”‚   â””â”€â”€ components/
â”‚
â”œâ”€â”€ dist/            # UMD æ ¼å¼ (æµè§ˆå™¨)
â”‚   â””â”€â”€ index.umd.js
â”‚
â””â”€â”€ .ldesign/
    â””â”€â”€ build-manifest.json  # æ„å»ºæ¸…å•
```

### Package.json é…ç½®

è‡ªåŠ¨ç”Ÿæˆï¼ˆæˆ–æ‰‹åŠ¨é…ç½®ï¼‰ï¼š

```json
{
  "main": "./lib/index.cjs",
  "module": "./es/index.js",
  "types": "./es/index.d.ts",
  "exports": {
    ".": {
      "import": "./es/index.js",
      "require": "./lib/index.cjs",
      "types": "./es/index.d.ts"
    }
  }
}
```

---

## ğŸ”¥ é«˜çº§åŠŸèƒ½

### å¹¶è¡Œæ„å»º

è‡ªåŠ¨å¯ç”¨ï¼Œæ— éœ€é…ç½®ï¼š

```bash
# è‡ªåŠ¨å¹¶è¡Œæ„å»º ESM + CJS + UMD
npx ldesign-builder build

# è¾“å‡º
âš¡ å¹¶è¡Œæ„å»º 3 ç§æ ¼å¼...
âœ“ ESM å®Œæˆ (4s)
âœ“ CJS å®Œæˆ (4s)
âœ“ UMD å®Œæˆ (4s)
âœ“ æ€»è®¡ 4sï¼ˆä¸²è¡Œéœ€è¦ 12sï¼‰
```

### ç›‘å¬æ¨¡å¼

```bash
npx ldesign-builder build --watch
```

### æ„å»ºåˆ†æ

```bash
npx ldesign-builder build --analyze
```

### è°ƒè¯•æ¨¡å¼

```bash
npx ldesign-builder build --debug
```

---

## â“ å¸¸è§é—®é¢˜

### Q: éœ€è¦é…ç½®æ–‡ä»¶å—ï¼Ÿ
**A**: 90% çš„é¡¹ç›®ä¸éœ€è¦ï¼å·¥å…·ä¼šè‡ªåŠ¨æ£€æµ‹å’Œé…ç½®ã€‚

### Q: å¦‚ä½•åŠ é€Ÿæ„å»ºï¼Ÿ
**A**: 
- å¼€å‘æ¨¡å¼ï¼š`--mode development` (ä½¿ç”¨ esbuild)
- æˆ–å®‰è£…å¯é€‰ä¾èµ–ï¼š`pnpm add esbuild @swc/core -D`

### Q: æ”¯æŒ Monorepo å—ï¼Ÿ
**A**: å®Œå…¨æ”¯æŒï¼è‡ªåŠ¨æ£€æµ‹ pnpm workspaceã€lernaã€nx ç­‰ã€‚

### Q: è¾“å‡ºç›®å½•å¯ä»¥è‡ªå®šä¹‰å—ï¼Ÿ
**A**: å¯ä»¥ï¼Œåœ¨é…ç½®æ–‡ä»¶ä¸­æŒ‡å®šï¼š
```typescript
export default {
  output: {
    esm: { dir: 'esm' },
    cjs: { dir: 'cjs' }
  }
}
```

### Q: å¦‚ä½•é€‰æ‹©æ‰“åŒ…å¼•æ“ï¼Ÿ
**A**: 
- è‡ªåŠ¨é€‰æ‹©ï¼ˆæ¨èï¼‰ï¼šä»€ä¹ˆéƒ½ä¸é…ç½®
- æ‰‹åŠ¨æŒ‡å®šï¼š`--bundler esbuild|swc|rollup|rolldown`

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [å¿«é€Ÿå¼€å§‹](./QUICK_START_ZH.md)
- [æœ€ç»ˆæŠ¥å‘Š](./FINAL_REPORT.md)
- [å®æ–½æ€»ç»“](./IMPLEMENTATION_SUMMARY.md)
- [å®ŒæˆçŠ¶æ€](./COMPLETION_STATUS.md)
- [README](./README.md)

---

## ğŸ’¬ è·å–å¸®åŠ©

- ğŸ“– æŸ¥çœ‹å®Œæ•´æ–‡æ¡£
- ğŸ› æäº¤ Issue
- ğŸ’¡ æŸ¥çœ‹ç¤ºä¾‹é¡¹ç›®

---

**å¼€å§‹ä½¿ç”¨å§ï¼** ğŸš€

```bash
npx ldesign-builder build
```



